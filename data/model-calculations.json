{
  "_description": "Model structure - formulas and relationships only",
  "calculationsTabs": [
    {
      "id": 1,
      "name": "IFS"
    },
    {
      "id": 2,
      "name": "Funding"
    },
    {
      "id": 3,
      "name": "Ops"
    },
    {
      "id": 4,
      "name": "Valuation"
    },
    {
      "id": 5,
      "name": "B/S"
    },
    {
      "id": 6,
      "name": "Cashflow"
    },
    {
      "id": 7,
      "name": "Debug"
    }
  ],
  "calculationsGroups": [
    {
      "id": 4,
      "tabId": 1,
      "name": "Profitability",
      "startYear": 2028,
      "startMonth": 10,
      "endYear": 2053,
      "endMonth": 9
    },
    {
      "id": 16,
      "tabId": 1,
      "name": "D&A"
    },
    {
      "id": 19,
      "tabId": 1,
      "name": "Tax"
    },
    {
      "id": 30,
      "tabId": 6,
      "name": "Operating CF"
    },
    {
      "id": 31,
      "tabId": 6,
      "name": "Investing CF"
    },
    {
      "id": 32,
      "tabId": 6,
      "name": "Financing CF"
    },
    {
      "id": 13,
      "tabId": 6,
      "name": "Cash Position"
    },
    {
      "id": 18,
      "tabId": 1,
      "name": "Working Capital"
    },
    {
      "id": 36,
      "tabId": 2,
      "name": "S&U: Uses"
    },
    {
      "id": 37,
      "tabId": 2,
      "name": "S&U: Sources"
    },
    {
      "id": 38,
      "tabId": 2,
      "name": "S&U: Check"
    },
    {
      "id": 15,
      "tabId": 2,
      "name": "Operations Debt"
    },
    {
      "id": 24,
      "tabId": 2,
      "name": "Covenants"
    },
    {
      "id": 26,
      "tabId": 2,
      "name": "Equity IRR"
    },
    {
      "id": 25,
      "tabId": 2,
      "name": "Dividends"
    },
    {
      "id": 34,
      "tabId": 2,
      "name": "SC Repayment"
    },
    {
      "id": 35,
      "tabId": 2,
      "name": "Profit Tests"
    },
    {
      "id": 27,
      "tabId": 3,
      "name": "Technical"
    },
    {
      "id": 28,
      "tabId": 3,
      "name": "Revenue"
    },
    {
      "id": 29,
      "tabId": 3,
      "name": "Opex"
    },
    {
      "id": 33,
      "tabId": 3,
      "name": "Maintenance"
    },
    {
      "id": 20,
      "tabId": 4,
      "name": "Free Cash Flow"
    },
    {
      "id": 21,
      "tabId": 4,
      "name": "Discount Factors"
    },
    {
      "id": 39,
      "tabId": 5,
      "name": "Assets"
    },
    {
      "id": 40,
      "tabId": 5,
      "name": "Liabilities"
    },
    {
      "id": 41,
      "tabId": 5,
      "name": "Equity"
    },
    {
      "id": 42,
      "tabId": 5,
      "name": "B/S Check"
    },
    {
      "id": 23,
      "tabId": "all",
      "name": "Calculations"
    },
    {
      "id": 50,
      "tabId": 1,
      "name": "Depreciation & Amortization",
      "_isModuleGroup": true,
      "_moduleTemplateId": "depreciation_amortization"
    },
    {
      "id": 51,
      "tabId": 1,
      "name": "GST Paid/Received",
      "_isModuleGroup": true,
      "_moduleTemplateId": "gst_receivable"
    },
    {
      "id": 52,
      "tabId": 2,
      "name": "Construction Funding",
      "_isModuleGroup": true,
      "_moduleTemplateId": "construction_funding"
    },
    {
      "id": 53,
      "tabId": 1,
      "name": "Tax & Tax Losses",
      "_isModuleGroup": true,
      "_moduleTemplateId": "tax_losses"
    },
    {
      "id": 54,
      "tabId": 2,
      "name": "MRA (Maintenance Reserve)",
      "_isModuleGroup": true,
      "_moduleTemplateId": "reserve_account"
    },
    {
      "id": 55,
      "tabId": 2,
      "name": "Distributions",
      "_isModuleGroup": true,
      "_moduleTemplateId": "distributions"
    },
    {
      "id": 56,
      "tabId": 2,
      "name": "Operations Debt Schedule",
      "_isModuleGroup": true,
      "_moduleTemplateId": "iterative_debt_sizing"
    },
    {
      "id": 57,
      "tabId": 2,
      "name": "DSRF Schedule",
      "_isModuleGroup": true,
      "_moduleTemplateId": "dsrf"
    },
    {
      "id": 58,
      "tabId": 4,
      "name": "Valuation Metrics"
    },
    {
      "id": 60,
      "tabId": 7,
      "name": "CF Waterfall (Levered)"
    },
    {
      "id": 61,
      "tabId": 7,
      "name": "P&L"
    }
  ],
  "calculations": [
    {
      "id": 119,
      "groupId": 27,
      "name": "Model Period",
      "formula": "CUMSUM(1)",
      "description": "Period counter (1, 2, 3, ...)",
      "type": "stock"
    },
    {
      "id": 120,
      "groupId": 27,
      "name": "Ops Period",
      "formula": "CUMSUM(F2)",
      "description": "Operations period counter (0 until ops, then 1, 2, 3, ...)",
      "type": "stock"
    },
    {
      "id": 3,
      "groupId": 27,
      "name": "Capex + Cont",
      "formula": "V1 * (1 + C1.23 / 100)",
      "description": "CAPEX with contingency applied"
    },
    {
      "id": 112,
      "groupId": 27,
      "name": "Capex to Apply GST",
      "formula": "V1 - V1.1 - V1.9",
      "description": "CAPEX minus EPC-BESS (import) minus Land Transaction (stamp duty) - both GST-free"
    },
    {
      "id": 4,
      "groupId": 28,
      "name": "Tolling Revenue",
      "formula": "C1.10 * C1.1 * T.HiY / T.MiY / 10^6 * F6 * I2",
      "description": "Contracted tolling revenue"
    },
    {
      "id": 5,
      "groupId": 28,
      "name": "FCAS Revenue",
      "formula": "L1.2 * C1.1 / T.MiY / 10^6 * F7 * I2",
      "description": "Frequency control ancillary services"
    },
    {
      "id": 6,
      "groupId": 28,
      "name": "Market Arbitrage Revenue",
      "formula": "L1.1 * C1.1 / 10^6 / T.MiY * F7 * R12 * I2",
      "description": "Arbitrage revenue (L1.1 annual, /12 for monthly)"
    },
    {
      "id": 179,
      "groupId": 28,
      "name": "Minor Event Revenue",
      "formula": "C1.1 * C1.43 / C1.44 / T.MiY / 10^6 * F7 * R12 * I2",
      "description": "Minor augmentation event revenue (capacity * $/MW / frequency / 12, technical adj, CPI-indexed)"
    },
    {
      "id": 180,
      "groupId": 28,
      "name": "Major Event Revenue",
      "formula": "C1.1 * C1.45 / C1.46 / T.MiY / 10^6 * F7 * R12 * I2",
      "description": "Major augmentation event revenue (capacity * $/MW / frequency / 12, technical adj, CPI-indexed)"
    },
    {
      "id": 181,
      "groupId": 28,
      "name": "Market Event Revenue",
      "formula": "R179 + R180",
      "description": "Minor + Major event revenue"
    },
    {
      "id": 7,
      "groupId": 28,
      "name": "Merchant Revenue",
      "formula": "(R5 + R6 + R181) * (1 - F4 + F4 * C1.56 / 100)",
      "description": "FCAS + Arbitrage + Market Events (95% during Life Extension)"
    },
    {
      "id": 8,
      "tabId": 1,
      "groupId": 4,
      "name": "Total Revenue",
      "formula": "R4 + R7",
      "description": "Tolling + Merchant"
    },
    {
      "id": 9,
      "tabId": 1,
      "groupId": 4,
      "name": "Total OPEX (Nominal)",
      "formula": "-S1 * I2",
      "description": "OPEX group sum"
    },
    {
      "id": 10,
      "tabId": 1,
      "groupId": 4,
      "name": "Gross Margin",
      "formula": "R8 + R9",
      "description": "Revenue minus OPEX"
    },
    {
      "id": 111,
      "groupId": 27,
      "name": "Monthly Decay Factor",
      "formula": "(1 - L3.5/100) ^ (T.DiM/T.DiY)",
      "description": "Per-month decay multiplier based on days",
      "type": "stock"
    },
    {
      "id": 11,
      "groupId": 27,
      "name": "Degradation Index",
      "formula": "CUMPROD(1 - F2 + F2 * R111)",
      "description": "1 before ops, then monthly compounding decay",
      "type": "stock"
    },
    {
      "id": 12,
      "groupId": 27,
      "name": "Operating Adjustment",
      "formula": "L3.1 / 100 * L3.2 / 100 * L3.3 / 100 * L3.4 / 100 * R11",
      "description": "Combined technical adjustment factor",
      "type": "stock"
    },
    {
      "id": 13,
      "tabId": 1,
      "groupId": 4,
      "name": "EBITDA",
      "formula": "R10",
      "description": "Earnings before interest, taxes, depreciation, amortization"
    },
    {
      "id": 14,
      "tabId": 1,
      "groupId": 4,
      "name": "P&L Depreciation",
      "formula": "-R9003",
      "description": "From D&A module"
    },
    {
      "id": 15,
      "tabId": 1,
      "groupId": 4,
      "name": "EBIT",
      "formula": "R13 + R14",
      "description": "Earnings before interest and taxes"
    },
    {
      "id": 16,
      "tabId": 1,
      "groupId": 4,
      "name": "Interest Expense",
      "formula": "-R71",
      "description": "From Operations Debt"
    },
    {
      "id": 17,
      "tabId": 1,
      "groupId": 4,
      "name": "EBT",
      "formula": "R15 + R16 + R151 + R174 - R144 - R146 + R153",
      "description": "Earnings before taxes (incl. agency fee, upfront fees, commitment fees, DSRF fees)"
    },
    {
      "id": 18,
      "tabId": 1,
      "groupId": 4,
      "name": "Tax Expense",
      "formula": "-R9031",
      "description": "From Tax module"
    },
    {
      "id": 19,
      "tabId": 1,
      "groupId": 4,
      "name": "NPAT",
      "formula": "R17 + R18",
      "description": "Net Profit After Tax"
    },
    {
      "id": 142,
      "tabId": 1,
      "groupId": 4,
      "name": "Prior RE",
      "formula": "R9038",
      "description": "RE before current period (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 138,
      "tabId": 1,
      "groupId": 4,
      "name": "P&L Dividends Declared",
      "formula": "-R9042",
      "description": "Dividends (from Distributions module)",
      "type": "flow"
    },
    {
      "id": 143,
      "tabId": 1,
      "groupId": 4,
      "name": "Share Capital Returned",
      "formula": "-R9047",
      "description": "Share capital repayment (from Distributions module)",
      "type": "flow"
    },
    {
      "id": 140,
      "tabId": 1,
      "groupId": 4,
      "name": "RE - Movement",
      "formula": "R9043",
      "description": "RE movement (from Distributions module)",
      "type": "flow"
    },
    {
      "id": 141,
      "tabId": 1,
      "groupId": 4,
      "name": "RE - Closing",
      "formula": "R9044",
      "description": "Retained earnings closing (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 20,
      "tabId": 3,
      "groupId": 30,
      "name": "Operating CF EBITDA",
      "formula": "R13",
      "description": ""
    },
    {
      "id": 21,
      "tabId": 3,
      "groupId": 30,
      "name": "Operating CF WC Movement",
      "formula": "-R98",
      "description": "Negative of NWC increase (increase uses cash)"
    },
    {
      "id": 174,
      "tabId": 3,
      "groupId": 32,
      "name": "Agency Fee",
      "formula": "-S3 * I2",
      "description": "Facility agent fee (indexed by CPI)"
    },
    {
      "id": 22,
      "tabId": 3,
      "groupId": 30,
      "name": "Operating CF",
      "formula": "R20 + R21",
      "description": "EBITDA + WC Movement"
    },
    {
      "id": 23,
      "tabId": 3,
      "groupId": 31,
      "name": "Capex",
      "formula": "-V1 * F1",
      "description": ""
    },
    {
      "id": 24,
      "tabId": 3,
      "groupId": 31,
      "name": "GST Paid on Capex",
      "formula": "R9008",
      "description": "From GST module (gst_paid outflow)"
    },
    {
      "id": 25,
      "tabId": 3,
      "groupId": 31,
      "name": "GST Received (Operations)",
      "formula": "R9014",
      "description": "GST receipts during operations (from module construction/operations split)"
    },
    {
      "id": 26,
      "tabId": 3,
      "groupId": 31,
      "name": "MRA Contribution",
      "formula": "-R9033",
      "description": "Cash contributed to MRA (funding outflow at F1.End)"
    },
    {
      "id": 27,
      "tabId": 3,
      "groupId": 31,
      "name": "MRA Release",
      "formula": "R9035",
      "description": "Cash released from MRA at end of maintenance period"
    },
    {
      "id": 149,
      "tabId": 3,
      "groupId": 31,
      "name": "MRA Drawdown (Maintenance)",
      "formula": "R9034",
      "description": "Cash inflow from MRA to pay maintenance (offsets OPEX in Operating CF)"
    },
    {
      "id": 202,
      "tabId": 3,
      "groupId": 31,
      "name": "GST Received (Construction)",
      "formula": "R9013",
      "description": "GST refund received during construction"
    },
    {
      "id": 28,
      "tabId": 3,
      "groupId": 31,
      "name": "Investing CF",
      "formula": "R23 + R24 + R25 + R26 + R27 + R149 + R202",
      "description": "Investing CF subtotal"
    },
    {
      "id": 29,
      "tabId": 3,
      "groupId": 32,
      "name": "Construction Debt Drawdown",
      "formula": "R9020",
      "description": "From Construction Funding module"
    },
    {
      "id": 31,
      "tabId": 3,
      "groupId": 32,
      "name": "Principal Repayment",
      "formula": "-R72",
      "description": "From Operations Debt"
    },
    {
      "id": 32,
      "tabId": 3,
      "groupId": 32,
      "name": "Interest Paid",
      "formula": "-R71",
      "description": "From Operations Debt"
    },
    {
      "id": 178,
      "tabId": 3,
      "groupId": 32,
      "name": "Total Debt Service",
      "formula": "R31 + R32 + R174 + R153",
      "description": "Principal + Interest + Agency Fee + DSRF Fees"
    },
    {
      "id": 33,
      "tabId": 3,
      "groupId": 32,
      "name": "DSRA Contribution",
      "formula": "0",
      "description": ""
    },
    {
      "id": 34,
      "tabId": 3,
      "groupId": 32,
      "name": "DSRA Release",
      "formula": "0",
      "description": ""
    },
    {
      "id": 151,
      "tabId": 3,
      "groupId": 32,
      "name": "Interest Income",
      "formula": "SHIFT(R42, 1) * C1.58 / 100 / T.MiY",
      "description": "Interest earned on prior period closing cash at C1.58 (% pa), monthly"
    },
    {
      "id": 152,
      "tabId": 3,
      "groupId": 32,
      "name": "DSRA Shortfall Contribution",
      "formula": "0",
      "description": "Placeholder - additional funding to DSRA when balance below target"
    },
    {
      "id": 153,
      "tabId": 3,
      "groupId": 32,
      "name": "DSRF Fees",
      "formula": "-R9082",
      "description": "Total DSRF fees (establishment + commitment + refinancing) from DSRF module"
    },
    {
      "id": 199,
      "tabId": 3,
      "groupId": 32,
      "name": "Upfront Fees Paid",
      "formula": "-R144",
      "description": "Cash outflow for upfront financing fees"
    },
    {
      "id": 200,
      "tabId": 3,
      "groupId": 32,
      "name": "Commitment Fees Paid",
      "formula": "-R146",
      "description": "Cash outflow for commitment fees"
    },
    {
      "id": 201,
      "tabId": 3,
      "groupId": 32,
      "name": "IDC Paid",
      "formula": "-R9022",
      "description": "Cash outflow for interest during construction"
    },
    {
      "id": 154,
      "tabId": 3,
      "groupId": 32,
      "name": "Share Capital Repayment",
      "formula": "-R9047",
      "description": "Return of equity capital (from Distributions module)"
    },
    {
      "id": 155,
      "tabId": 3,
      "groupId": 32,
      "name": "Dividends Paid",
      "formula": "-R9042",
      "description": "Dividend distributions to equity (from Distributions module)"
    },
    {
      "id": 60,
      "tabId": 3,
      "groupId": 36,
      "name": "Capex + Contingency",
      "formula": "CUMSUM(R3 * F1)",
      "description": "Cumulative capex with contingency during construction",
      "type": "stock"
    },
    {
      "id": 63,
      "tabId": 3,
      "groupId": 36,
      "name": "IDC",
      "formula": "R9019",
      "description": "From Construction Funding module",
      "type": "stock"
    },
    {
      "id": 144,
      "tabId": 3,
      "groupId": 36,
      "name": "Upfront Fees",
      "formula": "(M1.1 * C1.34 / 100 + C1.35) * F1.Start",
      "description": "Establishment fee (1.35% of limit) + upfront fees ($2M) at financial close",
      "type": "flow"
    },
    {
      "id": 146,
      "tabId": 3,
      "groupId": 36,
      "name": "Commitment Fees",
      "formula": "M1.1 * C1.33 / 100 * C1.36 / 100 / T.MiY * F1",
      "description": "Commitment fee on undrawn ops facility during construction (40% of 1.75% margin)",
      "type": "flow"
    },
    {
      "id": 173,
      "tabId": 3,
      "groupId": 36,
      "name": "Financing Fees",
      "formula": "CUMSUM(R144 + R146)",
      "description": "Cumulative upfront fees + commitment fees",
      "type": "stock"
    },
    {
      "id": 147,
      "tabId": 3,
      "groupId": 36,
      "name": "Agency Fees",
      "formula": "CUMSUM(S3 * I2 * F1)",
      "description": "Cumulative facility agent fee during construction (CPI-indexed, for S&U)",
      "type": "stock"
    },
    {
      "id": 62,
      "tabId": 3,
      "groupId": 36,
      "name": "MRA Funding",
      "formula": "CUMSUM(R9033)",
      "description": "MRA funded at end of construction (from MRA module)",
      "type": "stock"
    },
    {
      "id": 61,
      "tabId": 3,
      "groupId": 36,
      "name": "GST Paid",
      "formula": "CUMSUM(R24)",
      "description": "Cumulative of R24 (GST Paid on Capex)",
      "type": "stock"
    },
    {
      "id": 145,
      "tabId": 3,
      "groupId": 36,
      "name": "DSRF Facility Limit",
      "formula": "M8.1",
      "description": "DSRF facility limit (notional, from DSRF module)",
      "type": "flow"
    },
    {
      "id": 148,
      "tabId": 3,
      "groupId": 36,
      "name": "Construction Cash Reserving",
      "formula": "0",
      "description": "Placeholder",
      "type": "flow"
    },
    {
      "id": 64,
      "tabId": 3,
      "groupId": 36,
      "name": "Total Uses",
      "formula": "R60 + R63 + R173 + R147 + R62 + R61",
      "description": "Capex + IDC + Financing Fees + Agency Fees + MRA + GST Paid",
      "type": "stock"
    },
    {
      "id": 65,
      "tabId": 3,
      "groupId": 37,
      "name": "GST Received",
      "formula": "CUMSUM(R9013)",
      "description": "GST received during construction (1-month delay, from module split)",
      "type": "stock"
    },
    {
      "id": 66,
      "tabId": 3,
      "groupId": 37,
      "name": "Senior Debt",
      "formula": "R9016",
      "description": "From Construction Funding module",
      "type": "stock"
    },
    {
      "id": 67,
      "tabId": 3,
      "groupId": 37,
      "name": "Committed Equity",
      "formula": "R64 - R65 - R66",
      "description": "Equity is the residual: Total Uses - GST Received - Senior Debt",
      "type": "stock"
    },
    {
      "id": 68,
      "tabId": 3,
      "groupId": 37,
      "name": "Total Sources",
      "formula": "R65 + R66 + R67",
      "description": "GST Received + Senior Debt + Committed Equity",
      "type": "stock"
    },
    {
      "id": 69,
      "tabId": 3,
      "groupId": 38,
      "name": "Sources = Uses Check",
      "formula": "R68 - R64",
      "description": "Should be 0. Positive = excess sources, Negative = shortfall",
      "type": "stock"
    },
    {
      "id": 35,
      "tabId": 3,
      "groupId": 32,
      "name": "Construction Equity Injection",
      "formula": "R9021",
      "description": "From Construction Funding module"
    },
    {
      "id": 169,
      "tabId": 3,
      "groupId": 32,
      "name": "Financing CF (ex-Dist)",
      "formula": "R29 + R31 + R32 + R174 + R33 + R34 + R35 + R151 + R152 + R153 + R199 + R200 + R201",
      "description": "Financing flows excluding shareholder distributions"
    },
    {
      "id": 39,
      "tabId": 3,
      "groupId": 32,
      "name": "Financing CF",
      "formula": "R169 + R154 + R155",
      "description": "Sum of all financing flows (including distributions)"
    },
    {
      "id": 170,
      "tabId": 3,
      "groupId": 13,
      "name": "Net CF (ex-Dist)",
      "formula": "R22 + R28 + R169",
      "description": "Net cashflow before shareholder distributions"
    },
    {
      "id": 40,
      "tabId": 3,
      "groupId": 13,
      "name": "Net Cashflow",
      "formula": "R170 + R154 + R155",
      "description": "Net cashflow including distributions"
    },
    {
      "id": 41,
      "tabId": 3,
      "groupId": 13,
      "name": "Cash Opening Balance",
      "formula": "CUMSUM(R40) - R40",
      "description": "",
      "type": "stock_start"
    },
    {
      "id": 42,
      "tabId": 3,
      "groupId": 13,
      "name": "Cash Closing Balance",
      "formula": "CUMSUM(R40)",
      "description": "Final cash balance (includes all distributions)",
      "type": "stock"
    },
    {
      "id": 159,
      "groupId": 34,
      "name": "SC - Cash Available",
      "formula": "R9046",
      "description": "Cash available for SC repayment (from Distributions module)"
    },
    {
      "id": 160,
      "groupId": 34,
      "name": "SC - Repayment",
      "formula": "R9047",
      "description": "Share capital repayment (from Distributions module)"
    },
    {
      "id": 161,
      "groupId": 34,
      "name": "SC - Cumulative Returned",
      "formula": "CUMSUM(R9047)",
      "description": "Running total capital returned (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 123,
      "groupId": 25,
      "name": "Cash Available",
      "formula": "R9037",
      "description": "Cash available for distributions (from M7)"
    },
    {
      "id": 164,
      "groupId": 35,
      "name": "RE - Opening Balance",
      "formula": "R9038",
      "description": "Retained earnings opening (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 165,
      "groupId": 35,
      "name": "RE - NPAT",
      "formula": "R9039",
      "description": "NPAT (from Distributions module)"
    },
    {
      "id": 166,
      "groupId": 35,
      "name": "RE - Test Result",
      "formula": "R9040",
      "description": "RE test result (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 168,
      "groupId": 35,
      "name": "NPAT - Test Result",
      "formula": "R9041",
      "description": "NPAT test result (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 43,
      "tabId": 4,
      "groupId": 20,
      "name": "FCF EBITDA",
      "formula": "R13",
      "description": ""
    },
    {
      "id": 44,
      "tabId": 4,
      "groupId": 20,
      "name": "Capex (incl GST)",
      "formula": "R23 + R24 - R25",
      "description": ""
    },
    {
      "id": 45,
      "tabId": 4,
      "groupId": 20,
      "name": "FCF WC Movement",
      "formula": "R21",
      "description": ""
    },
    {
      "id": 46,
      "tabId": 4,
      "groupId": 20,
      "name": "FCFF",
      "formula": "R43 + R44 + R45",
      "description": "Free Cash Flow to Firm"
    },
    {
      "id": 47,
      "tabId": 4,
      "groupId": 20,
      "name": "FCF Debt Service",
      "formula": "R31 + R32",
      "description": ""
    },
    {
      "id": 48,
      "tabId": 4,
      "groupId": 20,
      "name": "FCF Debt Drawdown",
      "formula": "R29",
      "description": "Construction + Ops debt"
    },
    {
      "id": 49,
      "tabId": 4,
      "groupId": 20,
      "name": "FCFE",
      "formula": "R46 + R47 + R48",
      "description": "Free Cash Flow to Equity"
    },
    {
      "id": 50,
      "tabId": 4,
      "groupId": 21,
      "name": "Monthly Discount Rate",
      "formula": "(1 + C1.12 / 100) ^ (1/T.MiY) - 1",
      "description": "WACC converted to monthly",
      "type": "stock"
    },
    {
      "id": 51,
      "tabId": 4,
      "groupId": 21,
      "name": "Discount Factor",
      "formula": "CUMPROD(1 / (1 + R50))",
      "description": "Cumulative discount factor for NPV",
      "type": "stock"
    },
    {
      "id": 131,
      "tabId": 4,
      "groupId": 26,
      "name": "Contingent Equity",
      "formula": "0",
      "description": "Additional equity calls beyond initial (if any)"
    },
    {
      "id": 132,
      "tabId": 4,
      "groupId": 26,
      "name": "Equity Injections",
      "formula": "-R35",
      "description": "Periodic equity drawdowns during construction (outflow)"
    },
    {
      "id": 133,
      "tabId": 4,
      "groupId": 26,
      "name": "Dividends",
      "formula": "R9042",
      "description": "Dividend distributions to equity (from Distributions module)"
    },
    {
      "id": 134,
      "tabId": 4,
      "groupId": 26,
      "name": "Share Capital Repayment",
      "formula": "R9047",
      "description": "Return of equity capital (from Distributions module)"
    },
    {
      "id": 135,
      "tabId": 4,
      "groupId": 26,
      "name": "Investor Tax",
      "formula": "-(R133 + R134) * C1.29 / 100",
      "description": "Withholding tax on distributions (outflow)"
    },
    {
      "id": 136,
      "tabId": 4,
      "groupId": 26,
      "name": "Terminal Value",
      "formula": "C1.30 * I2 * F5",
      "description": "Fixed terminal value ($17.5M) indexed by CPI at TV period"
    },
    {
      "id": 137,
      "tabId": 4,
      "groupId": 26,
      "name": "Net Cash Flow to Equity",
      "formula": "R131 + R132 + R133 + R134 + R135 + R136",
      "description": "Total equity cash flows for IRR calculation"
    },
    {
      "id": 115,
      "tabId": 3,
      "groupId": 24,
      "name": "Contracted CFADS",
      "formula": "R13 * R4 / R8 * F2",
      "description": "EBITDA allocated to contracted revenue (Tolling)"
    },
    {
      "id": 116,
      "tabId": 3,
      "groupId": 24,
      "name": "Merchant CFADS",
      "formula": "R13 * R7 / R8 * F2",
      "description": "EBITDA allocated to merchant revenue (FCAS + Arb)"
    },
    {
      "id": 118,
      "tabId": 3,
      "groupId": 24,
      "name": "DSCR",
      "formula": "R9071",
      "description": "Debt Service Coverage Ratio",
      "type": "stock"
    },
    {
      "id": 205,
      "tabId": 3,
      "groupId": 24,
      "name": "Total CFADS",
      "formula": "R115 + R116",
      "description": "Combined contracted + merchant CFADS for ADSCR calculation"
    },
    {
      "id": 208,
      "groupId": 24,
      "name": "Contracted CFADS Post Capex",
      "formula": "R115",
      "description": "Contracted CFADS (maintenance already in OPEX/EBITDA)"
    },
    {
      "id": 209,
      "groupId": 24,
      "name": "Merchant CFADS Post Capex",
      "formula": "R116",
      "description": "Merchant CFADS (maintenance already in OPEX/EBITDA)"
    },
    {
      "id": 207,
      "groupId": 24,
      "name": "Total CFADS Post Capex",
      "formula": "R208 + R209",
      "description": "Total CFADS after maintenance capex deduction"
    },
    {
      "id": 70,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Opening Balance",
      "formula": "R9063",
      "description": "From iterative debt sizing module",
      "type": "stock_start"
    },
    {
      "id": 71,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Interest Paid",
      "formula": "R9066",
      "description": "From iterative debt sizing module"
    },
    {
      "id": 72,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Principal Repayment",
      "formula": "R9067",
      "description": "From iterative debt sizing module"
    },
    {
      "id": 73,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Service (P+I)",
      "formula": "R9068",
      "description": "Interest + Principal from iterative debt sizing module"
    },
    {
      "id": 74,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Closing Balance",
      "formula": "R9070",
      "description": "From iterative debt sizing module",
      "type": "stock"
    },
    {
      "id": 203,
      "tabId": 1,
      "groupId": 16,
      "name": "Total Capital Additions",
      "formula": "V1 + R9022",
      "description": "Per-period capex + IDC (combined additions for D&A depreciable base)"
    },
    {
      "id": 80,
      "tabId": 1,
      "groupId": 16,
      "name": "D&A Opening Book Value",
      "formula": "R9001",
      "description": "From D&A module",
      "type": "stock_start"
    },
    {
      "id": 81,
      "tabId": 1,
      "groupId": 16,
      "name": "D&A Asset Addition",
      "formula": "R9002",
      "description": "From D&A module"
    },
    {
      "id": 82,
      "tabId": 1,
      "groupId": 16,
      "name": "D&A Depreciation Expense",
      "formula": "R9003",
      "description": "From D&A module"
    },
    {
      "id": 83,
      "tabId": 1,
      "groupId": 16,
      "name": "D&A Accumulated Depreciation",
      "formula": "R9004",
      "description": "From D&A module",
      "type": "stock"
    },
    {
      "id": 84,
      "tabId": 1,
      "groupId": 16,
      "name": "D&A Closing Book Value",
      "formula": "R9005",
      "description": "From D&A module",
      "type": "stock"
    },
    {
      "id": 175,
      "tabId": 3,
      "groupId": 18,
      "name": "Tolling Quarterly Accrual",
      "formula": "R4 + SHIFT(R4,1)*(1-SHIFT(T.QE,1)) + SHIFT(R4,2)*(1-SHIFT(T.QE,2))*(1-SHIFT(T.QE,1))",
      "description": "Rolling quarterly sum of tolling revenue (resets after each QE)",
      "type": "stock"
    },
    {
      "id": 176,
      "tabId": 3,
      "groupId": 18,
      "name": "Tolling Receivable",
      "formula": "R175 * (1 - T.QE)",
      "description": "Tolling AR - accrues monthly, collected at quarter end",
      "type": "stock"
    },
    {
      "id": 177,
      "tabId": 3,
      "groupId": 18,
      "name": "Merchant Receivable",
      "formula": "R7 * C1.13 / 30",
      "description": "Merchant revenue receivable (days-based)",
      "type": "stock"
    },
    {
      "id": 95,
      "tabId": 3,
      "groupId": 18,
      "name": "Receivables",
      "formula": "R176 + R177",
      "description": "Tolling (quarterly) + Merchant (days-based)",
      "type": "stock"
    },
    {
      "id": 96,
      "tabId": 3,
      "groupId": 18,
      "name": "Payables",
      "formula": "ABS(R9) * C1.14 / 30",
      "description": "OPEX * Payable Days / Days Per Month",
      "type": "stock"
    },
    {
      "id": 97,
      "tabId": 3,
      "groupId": 18,
      "name": "Net Working Capital",
      "formula": "R95 - R96",
      "description": "Receivables minus Payables",
      "type": "stock"
    },
    {
      "id": 98,
      "tabId": 3,
      "groupId": 18,
      "name": "Net WC Movement",
      "formula": "R97 - SHIFT(R97, 1)",
      "description": "Change in NWC = Closing NWC - Prior NWC"
    },
    {
      "id": 100,
      "tabId": 3,
      "groupId": 19,
      "name": "Tax Taxable Income",
      "formula": "R9025",
      "description": "From Tax module"
    },
    {
      "id": 101,
      "tabId": 3,
      "groupId": 19,
      "name": "Loss Pool Opening",
      "formula": "R9026",
      "description": "From Tax module",
      "type": "stock_start"
    },
    {
      "id": 102,
      "tabId": 3,
      "groupId": 19,
      "name": "Losses Utilised",
      "formula": "R9028",
      "description": "From Tax module"
    },
    {
      "id": 105,
      "tabId": 3,
      "groupId": 19,
      "name": "Loss Pool Closing",
      "formula": "R9029",
      "description": "From Tax module",
      "type": "stock"
    },
    {
      "id": 103,
      "tabId": 3,
      "groupId": 19,
      "name": "Tax Net Taxable Income",
      "formula": "R9030",
      "description": "From Tax module"
    },
    {
      "id": 104,
      "tabId": 3,
      "groupId": 19,
      "name": "Tax Payable",
      "formula": "R9031",
      "description": "From Tax module"
    },
    {
      "id": 171,
      "groupId": 27,
      "name": "All-in Interest Rate - Construction (%)",
      "formula": "L2.2 + C1.32",
      "description": "Base Rate (L2.2) + Construction Margin (C1.32 = 1.8%)",
      "type": "stock"
    },
    {
      "id": 172,
      "groupId": 27,
      "name": "All-in Interest Rate - Operations (%)",
      "formula": "L2.2 + C1.33",
      "description": "Base Rate (L2.2) + Operations Margin (C1.33 = 1.75%)",
      "type": "stock"
    },
    {
      "id": 182,
      "groupId": 39,
      "name": "Cash & Cash Equivalents",
      "formula": "R42",
      "description": "Closing cash position",
      "type": "stock"
    },
    {
      "id": 196,
      "groupId": 39,
      "name": "Construction WIP",
      "formula": "(CUMSUM(V1 * F1) + R63) * F1",
      "description": "Capex + capitalised IDC during construction (zero after COD â€” asset transfers to PP&E via D&A module)",
      "type": "stock"
    },
    {
      "id": 183,
      "groupId": 39,
      "name": "PP&E (Net Book Value)",
      "formula": "R84",
      "description": "D&A closing balance (net of accumulated depreciation, post-COD)",
      "type": "stock"
    },
    {
      "id": 184,
      "groupId": 39,
      "name": "Trade Receivables",
      "formula": "R95",
      "description": "Tolling + Merchant receivables",
      "type": "stock"
    },
    {
      "id": 185,
      "groupId": 39,
      "name": "GST Receivable",
      "formula": "R9011",
      "description": "GST receivable closing balance from GST module",
      "type": "stock"
    },
    {
      "id": 186,
      "groupId": 39,
      "name": "MRA Balance",
      "formula": "R9036",
      "description": "Maintenance reserve account closing balance",
      "type": "stock"
    },
    {
      "id": 187,
      "groupId": 39,
      "name": "Total Assets",
      "formula": "R182 + R196 + R183 + R184 + R185 + R186",
      "description": "Cash + WIP + PP&E + Receivables + GST + MRA",
      "type": "stock"
    },
    {
      "id": 198,
      "groupId": 40,
      "name": "Construction Debt",
      "formula": "R9016 * F1",
      "description": "Cumulative senior debt drawn during construction (M4.2), zero after COD",
      "type": "stock"
    },
    {
      "id": 188,
      "groupId": 40,
      "name": "Operations Debt",
      "formula": "R74",
      "description": "Operations debt closing balance (M1.6), active from COD",
      "type": "stock"
    },
    {
      "id": 189,
      "groupId": 40,
      "name": "Trade Payables",
      "formula": "R96",
      "description": "OPEX-based payables (30-day terms)",
      "type": "stock"
    },
    {
      "id": 190,
      "groupId": 40,
      "name": "Total Liabilities",
      "formula": "R198 + R188 + R189",
      "description": "Construction Debt + Operations Debt + Payables",
      "type": "stock"
    },
    {
      "id": 191,
      "groupId": 41,
      "name": "Share Capital",
      "formula": "CUMSUM(R9021) * F1 + R9048 * F2",
      "description": "Construction: cumulative equity drawn (R9021) gated by F1. Operations: SC closing from distributions module (M7.12) gated by F2.",
      "type": "stock"
    },
    {
      "id": 192,
      "groupId": 41,
      "name": "Retained Earnings",
      "formula": "R141",
      "description": "Retained earnings closing balance",
      "type": "stock"
    },
    {
      "id": 193,
      "groupId": 41,
      "name": "Total Equity",
      "formula": "R191 + R192",
      "description": "Share capital + retained earnings",
      "type": "stock"
    },
    {
      "id": 194,
      "groupId": 42,
      "name": "Total L + E",
      "formula": "R190 + R193",
      "description": "Total liabilities plus total equity",
      "type": "stock"
    },
    {
      "id": 195,
      "groupId": 42,
      "name": "Balance Check",
      "formula": "R187 - R194",
      "description": "Should be zero if B/S balances (Total Assets - Total L&E)",
      "type": "stock"
    },
    {
      "id": 9001,
      "groupId": 50,
      "name": "Depreciation & Amortization: Opening Book Value",
      "formula": "MAX(0, (CUMSUM(R9002) - R9002) - CUMSUM(R203) / C1.24 / T.MiY * (CUMSUM(F2) - F2))",
      "type": "stock_start",
      "_moduleId": "M2",
      "_moduleOutputKey": "opening"
    },
    {
      "id": 9002,
      "groupId": 50,
      "name": "Depreciation & Amortization: Capital Addition",
      "formula": "CUMSUM(R203) * F2.Start",
      "type": "flow",
      "_moduleId": "M2",
      "_moduleOutputKey": "addition"
    },
    {
      "id": 9003,
      "groupId": 50,
      "name": "Depreciation & Amortization: Depreciation Expense",
      "formula": "MIN(R9001 + R9002, CUMSUM(R203) / C1.24 / T.MiY) * F2",
      "type": "flow",
      "_moduleId": "M2",
      "_moduleOutputKey": "depreciation"
    },
    {
      "id": 9004,
      "groupId": 50,
      "name": "Depreciation & Amortization: Accumulated Depreciation",
      "formula": "CUMSUM(R9003)",
      "type": "stock",
      "_moduleId": "M2",
      "_moduleOutputKey": "accumulated"
    },
    {
      "id": 9005,
      "groupId": 50,
      "name": "Depreciation & Amortization: Closing Book Value",
      "formula": "MAX(0, CUMSUM(R9002) - CUMSUM(R203) / C1.24 / T.MiY * CUMSUM(F2))",
      "type": "stock",
      "_moduleId": "M2",
      "_moduleOutputKey": "closing"
    },
    {
      "id": 9006,
      "groupId": 51,
      "name": "GST Paid/Received: GST Base Amount",
      "formula": "R112",
      "type": "flow",
      "_moduleId": "M3",
      "_moduleOutputKey": "gst_base"
    },
    {
      "id": 9007,
      "groupId": 51,
      "name": "GST Paid/Received: GST Amount",
      "formula": "R112 * C1.15 / 100 * F1",
      "type": "flow",
      "_moduleId": "M3",
      "_moduleOutputKey": "gst_amount"
    },
    {
      "id": 9008,
      "groupId": 51,
      "name": "GST Paid/Received: GST Paid (Outflow)",
      "formula": "-R9007",
      "type": "flow",
      "_moduleId": "M3",
      "_moduleOutputKey": "gst_paid"
    },
    {
      "id": 9009,
      "groupId": 51,
      "name": "GST Paid/Received: GST Receivable - Opening",
      "formula": "(CUMSUM(R9007) - R9007) - (CUMSUM(R9010) - R9010)",
      "type": "stock_start",
      "_moduleId": "M3",
      "_moduleOutputKey": "receivable_opening"
    },
    {
      "id": 9010,
      "groupId": 51,
      "name": "GST Paid/Received: GST Received (Inflow)",
      "formula": "PREVVAL(R9007)",
      "type": "flow",
      "_moduleId": "M3",
      "_moduleOutputKey": "gst_received"
    },
    {
      "id": 9011,
      "groupId": 51,
      "name": "GST Paid/Received: GST Receivable - Closing",
      "formula": "CUMSUM(R9007) - CUMSUM(R9010)",
      "type": "stock",
      "_moduleId": "M3",
      "_moduleOutputKey": "receivable_closing"
    },
    {
      "id": 9012,
      "groupId": 51,
      "name": "GST Paid/Received: Net GST Cash Flow",
      "formula": "R9008 + R9010",
      "type": "flow",
      "_moduleId": "M3",
      "_moduleOutputKey": "net_gst_cashflow"
    },
    {
      "id": 9013,
      "groupId": 51,
      "name": "GST Paid/Received: GST Received (Construction)",
      "formula": "R9010 * F1",
      "type": "flow",
      "_moduleId": "M3",
      "_moduleOutputKey": "gst_received_construction"
    },
    {
      "id": 9014,
      "groupId": 51,
      "name": "GST Paid/Received: GST Received (Operations)",
      "formula": "R9010 * F2",
      "type": "flow",
      "_moduleId": "M3",
      "_moduleOutputKey": "gst_received_operations"
    },
    {
      "id": 9015,
      "groupId": 52,
      "name": "Construction Funding: Total Funding Requirements",
      "formula": "R9023 + CUMSUM(R9022)",
      "type": "stock",
      "_moduleId": "M4",
      "_moduleOutputKey": "total_uses_incl_idc"
    },
    {
      "id": 9016,
      "groupId": 52,
      "name": "Construction Funding: Senior Debt",
      "formula": "CUMSUM(R9020)",
      "type": "stock",
      "_moduleId": "M4",
      "_moduleOutputKey": "senior_debt"
    },
    {
      "id": 9017,
      "groupId": 52,
      "name": "Construction Funding: Equity",
      "formula": "CUMSUM(R9021) + CUMSUM(R9022)",
      "type": "stock",
      "_moduleId": "M4",
      "_moduleOutputKey": "equity"
    },
    {
      "id": 9018,
      "groupId": 52,
      "name": "Construction Funding: Gearing %",
      "formula": "C1.19 * (CUMSUM(F1) > 0)",
      "type": "stock",
      "_moduleId": "M4",
      "_moduleOutputKey": "gearing_pct"
    },
    {
      "id": 9019,
      "groupId": 52,
      "name": "Construction Funding: IDC",
      "formula": "CUMSUM(R9022) * F1",
      "type": "stock",
      "_moduleId": "M4",
      "_moduleOutputKey": "cumulative_idc"
    },
    {
      "id": 9020,
      "groupId": 52,
      "name": "Construction Funding: Debt Drawdown",
      "formula": "MAX(0, CUMSUM(R9024) - R9099) - MAX(0, CUMSUM(R9024) - R9024 - R9099)",
      "type": "flow",
      "_moduleId": "M4",
      "_moduleOutputKey": "debt_drawdown"
    },
    {
      "id": 9021,
      "groupId": 52,
      "name": "Construction Funding: Equity Drawdown",
      "formula": "(R9024 - R9020) * F1",
      "type": "flow",
      "_moduleId": "M4",
      "_moduleOutputKey": "equity_drawdown"
    },
    {
      "id": 9022,
      "groupId": 52,
      "name": "Construction Funding: IDC (Period)",
      "formula": "(CUMSUM(R9020) - R9020) * R171 / 100 / T.MiY * F1",
      "type": "flow",
      "_moduleId": "M4",
      "_moduleOutputKey": "idc"
    },
    {
      "id": 9023,
      "groupId": 52,
      "name": "Construction Funding: Total Uses (ex-IDC)",
      "formula": "R60 + R61 + R173",
      "type": "stock",
      "_moduleId": "M4",
      "_moduleOutputKey": "total_uses_ex_idc"
    },
    {
      "id": 9024,
      "groupId": 52,
      "name": "Construction Funding: Period Cost",
      "formula": "MAX(0, R9023 - PREVVAL(R9023)) * F1",
      "type": "flow",
      "_moduleId": "M4",
      "_moduleOutputKey": "period_cost"
    },
    {
      "id": 9025,
      "groupId": 53,
      "name": "Tax & Tax Losses: Taxable Income Before Losses",
      "formula": "0",
      "type": "flow",
      "_moduleId": "M5",
      "_moduleOutputKey": "taxable_income_before_losses"
    },
    {
      "id": 9026,
      "groupId": 53,
      "name": "Tax & Tax Losses: Tax Losses - Opening",
      "formula": "0",
      "type": "stock_start",
      "_moduleId": "M5",
      "_moduleOutputKey": "losses_opening"
    },
    {
      "id": 9027,
      "groupId": 53,
      "name": "Tax & Tax Losses: Tax Losses - Generated",
      "formula": "0",
      "type": "flow",
      "_moduleId": "M5",
      "_moduleOutputKey": "losses_generated"
    },
    {
      "id": 9028,
      "groupId": 53,
      "name": "Tax & Tax Losses: Tax Losses - Utilised",
      "formula": "0",
      "type": "flow",
      "_moduleId": "M5",
      "_moduleOutputKey": "losses_utilised"
    },
    {
      "id": 9029,
      "groupId": 53,
      "name": "Tax & Tax Losses: Tax Losses - Closing",
      "formula": "0",
      "type": "stock",
      "_moduleId": "M5",
      "_moduleOutputKey": "losses_closing"
    },
    {
      "id": 9030,
      "groupId": 53,
      "name": "Tax & Tax Losses: Net Taxable Income",
      "formula": "0",
      "type": "flow",
      "_moduleId": "M5",
      "_moduleOutputKey": "net_taxable_income"
    },
    {
      "id": 9031,
      "groupId": 53,
      "name": "Tax & Tax Losses: Tax Payable",
      "formula": "0",
      "type": "flow",
      "_moduleId": "M5",
      "_moduleOutputKey": "tax_payable"
    },
    {
      "id": 9032,
      "groupId": 54,
      "name": "MRA (Maintenance Reserve): Opening Balance",
      "formula": "MAX(0, (CUMSUM(R9033) - R9033) - (CUMSUM(R9034) - R9034) - (CUMSUM(R9035) - R9035))",
      "type": "stock_start",
      "_moduleId": "M6",
      "_moduleOutputKey": "opening"
    },
    {
      "id": 9033,
      "groupId": 54,
      "name": "MRA (Maintenance Reserve): Funding",
      "formula": "C1.17 * F1.End",
      "type": "flow",
      "_moduleId": "M6",
      "_moduleOutputKey": "funding"
    },
    {
      "id": 9034,
      "groupId": 54,
      "name": "MRA (Maintenance Reserve): Drawdown",
      "formula": "MIN(ABS(S1.19) * I2 * T.MiQ * T.QE * F12, MAX(0, CUMSUM(R9033) - (CUMSUM(ABS(S1.19) * I2 * T.MiQ * T.QE * F12) - ABS(S1.19) * I2 * T.MiQ * T.QE * F12))) * F12 * T.QE",
      "type": "flow",
      "_moduleId": "M6",
      "_moduleOutputKey": "drawdown"
    },
    {
      "id": 9035,
      "groupId": 54,
      "name": "MRA (Maintenance Reserve): Release",
      "formula": "MAX(0, CUMSUM(R9033) - CUMSUM(R9034)) * F12.End",
      "type": "flow",
      "_moduleId": "M6",
      "_moduleOutputKey": "release"
    },
    {
      "id": 9036,
      "groupId": 54,
      "name": "MRA (Maintenance Reserve): Closing Balance",
      "formula": "MAX(0, CUMSUM(R9033) - CUMSUM(R9034) - CUMSUM(R9035))",
      "type": "stock",
      "_moduleId": "M6",
      "_moduleOutputKey": "closing"
    },
    {
      "id": 9037,
      "groupId": 55,
      "name": "Distributions: Cash Available for Dist",
      "formula": "MAX(0, CUMSUM(R170) - PREVSUM(R9049) - C1.28) * F2",
      "type": "flow",
      "_moduleId": "M7",
      "_moduleOutputKey": "cash_available"
    },
    {
      "id": 9038,
      "groupId": 55,
      "name": "Distributions: RE - Opening",
      "formula": "PREVSUM(R9043)",
      "type": "stock_start",
      "_moduleId": "M7",
      "_moduleOutputKey": "re_opening"
    },
    {
      "id": 9039,
      "groupId": 55,
      "name": "Distributions: RE - NPAT",
      "formula": "R19",
      "type": "flow",
      "_moduleId": "M7",
      "_moduleOutputKey": "re_npat"
    },
    {
      "id": 9040,
      "groupId": 55,
      "name": "Distributions: RE Test",
      "formula": "(R9038 + R9039 > 0)",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "re_test"
    },
    {
      "id": 9041,
      "groupId": 55,
      "name": "Distributions: NPAT Test",
      "formula": "(R9039 > 0)",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "npat_test"
    },
    {
      "id": 9042,
      "groupId": 55,
      "name": "Distributions: Dividend Paid",
      "formula": "MIN(R9046, MAX(0, R9039)) * F2 * R9040 * R9041 * (1 - R9057)",
      "type": "flow",
      "_moduleId": "M7",
      "_moduleOutputKey": "dividend_paid"
    },
    {
      "id": 9043,
      "groupId": 55,
      "name": "Distributions: RE - Movement",
      "formula": "R9039 - R9042",
      "type": "flow",
      "_moduleId": "M7",
      "_moduleOutputKey": "re_movement"
    },
    {
      "id": 9044,
      "groupId": 55,
      "name": "Distributions: RE - Closing",
      "formula": "PREVSUM(R9043) + R9043",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "re_closing"
    },
    {
      "id": 9045,
      "groupId": 55,
      "name": "Distributions: SC - Opening",
      "formula": "CUMSUM(R9021)",
      "type": "stock_start",
      "_moduleId": "M7",
      "_moduleOutputKey": "sc_opening"
    },
    {
      "id": 9046,
      "groupId": 55,
      "name": "Distributions: Post-SC Cash Available",
      "formula": "MAX(0, R9037 - R9047)",
      "type": "flow",
      "_moduleId": "M7",
      "_moduleOutputKey": "sc_cash_available"
    },
    {
      "id": 9047,
      "groupId": 55,
      "name": "Distributions: SC - Repayment",
      "formula": "MIN(R9037, MAX(0, R9045 - PREVSUM(R9047))) * F2 * (1 - R9057)",
      "type": "flow",
      "_moduleId": "M7",
      "_moduleOutputKey": "sc_repayment"
    },
    {
      "id": 9048,
      "groupId": 55,
      "name": "Distributions: SC - Closing",
      "formula": "MAX(0, R9045 - CUMSUM(R9047))",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "sc_closing"
    },
    {
      "id": 9049,
      "groupId": 55,
      "name": "Distributions: Total Distributions",
      "formula": "R9042 + R9047",
      "type": "flow",
      "_moduleId": "M7",
      "_moduleOutputKey": "total_distributions"
    },
    {
      "id": 9050,
      "groupId": 55,
      "name": "Distributions: Withholding Tax",
      "formula": "R9049 * 0 / 100",
      "type": "flow",
      "_moduleId": "M7",
      "_moduleOutputKey": "withholding_tax"
    },
    {
      "id": 9051,
      "groupId": 55,
      "name": "Distributions: Net to Equity",
      "formula": "R9049 - R9050",
      "type": "flow",
      "_moduleId": "M7",
      "_moduleOutputKey": "net_to_equity"
    },
    {
      "id": 9052,
      "groupId": 55,
      "name": "Distributions: DSCR Test",
      "formula": "MAX((R9071 >= C1.47), (ABS(R9068) < 0.001)) * F2",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "dscr_test"
    },
    {
      "id": 9053,
      "groupId": 55,
      "name": "Distributions: ADSCR Test",
      "formula": "F2",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "adscr_test"
    },
    {
      "id": 9054,
      "groupId": 55,
      "name": "Distributions: DSRA Test",
      "formula": "F2",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "dsra_test"
    },
    {
      "id": 9055,
      "groupId": 55,
      "name": "Distributions: All Tests Pass",
      "formula": "(PREVVAL(R9055) * (1 - T.QE) + R9052 * R9053 * R9054 * T.QE) * F2 + PREVVAL(R9055) * (1 - F2) * (CUMSUM(F2) > 0)",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "all_tests_pass"
    },
    {
      "id": 9056,
      "groupId": 55,
      "name": "Distributions: Consecutive Pass Qtrs",
      "formula": "PREVVAL(R9056) * (R9055 * T.QE + (1 - T.QE)) + R9055 * T.QE",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "consec_pass_qtrs"
    },
    {
      "id": 9057,
      "groupId": 55,
      "name": "Distributions: Lock-up Active",
      "formula": "MAX((R9056 < C1.49) * F2, F1)",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "lockup_active"
    },
    {
      "id": 9058,
      "groupId": 55,
      "name": "Distributions: Cumulative Distributions",
      "formula": "CUMSUM(R9049)",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "cumulative_distributions"
    },
    {
      "id": 9059,
      "groupId": 55,
      "name": "Distributions: Cumulative SC Repayment",
      "formula": "CUMSUM(R9047)",
      "type": "stock",
      "_moduleId": "M7",
      "_moduleOutputKey": "cumulative_sc_repayment"
    },
    {
      "id": 9060,
      "groupId": 56,
      "name": "DS Capacity (Monthly)",
      "formula": "(R208 / C1.25 + R209 / C1.26) * F8",
      "type": "flow",
      "_moduleId": "M1",
      "_moduleOutputKey": "ds_capacity_monthly"
    },
    {
      "id": 9061,
      "groupId": 56,
      "name": "Monthly Interest",
      "formula": "R9063 * R172 / 100 / T.MiY * F8",
      "type": "flow",
      "_moduleId": "M1",
      "_moduleOutputKey": "monthly_interest"
    },
    {
      "id": 9062,
      "groupId": 56,
      "name": "Accrued Interest (Intra-Qtr)",
      "formula": "(PREVVAL(R9062) * (1 - PREVVAL(T.QE)) + R9061) * F8",
      "type": "stock",
      "_moduleId": "M1",
      "_moduleOutputKey": "accrued_interest"
    },
    {
      "id": 9063,
      "groupId": 56,
      "name": "Opening Balance",
      "formula": "PREVVAL(R9070) + M1.1 * F8.Start",
      "type": "stock",
      "_moduleId": "M1",
      "_moduleOutputKey": "opening_balance"
    },
    {
      "id": 9064,
      "groupId": 56,
      "name": "Accrued Capacity (Intra-Qtr)",
      "formula": "(PREVVAL(R9064) * (1 - PREVVAL(T.QE)) + R9060) * F8",
      "type": "stock",
      "_moduleId": "M1",
      "_moduleOutputKey": "accrued_capacity"
    },
    {
      "id": 9065,
      "groupId": 56,
      "name": "Remaining Payment Periods",
      "formula": "IF(F8.Start, C1.27 * T.QiY, MAX(1, PREVVAL(R9065) - PREVVAL(R9073))) * F8",
      "type": "stock",
      "_moduleId": "M1",
      "_moduleOutputKey": "remaining_periods"
    },
    {
      "id": 9066,
      "groupId": 56,
      "name": "Interest Payment",
      "formula": "R9062 * R9073 * F8",
      "type": "flow",
      "_moduleId": "M1",
      "_moduleOutputKey": "interest_payment"
    },
    {
      "id": 9067,
      "groupId": 56,
      "name": "Principal Payment",
      "formula": "MIN(MAX(0, R9064 - R9066), R9063) * R9073 * F8",
      "type": "flow",
      "_moduleId": "M1",
      "_moduleOutputKey": "principal_payment",
      "description": "Fully DSCR-sculpted: capacity minus interest, capped at outstanding balance"
    },
    {
      "id": 9068,
      "groupId": 56,
      "name": "Debt Service",
      "formula": "R9066 + R9067",
      "type": "flow",
      "_moduleId": "M1",
      "_moduleOutputKey": "debt_service"
    },
    {
      "id": 9069,
      "groupId": 56,
      "name": "Accrued CFADS (Intra-Qtr)",
      "formula": "(PREVVAL(R9069) * (1 - PREVVAL(T.QE)) + R208 + R209) * F8",
      "type": "stock",
      "_moduleId": "M1",
      "_moduleOutputKey": "accrued_cfads"
    },
    {
      "id": 9070,
      "groupId": 56,
      "name": "Closing Balance",
      "formula": "MAX(0, R9063 - R9067)",
      "type": "stock",
      "_moduleId": "M1",
      "_moduleOutputKey": "closing_balance"
    },
    {
      "id": 9071,
      "groupId": 56,
      "name": "Period DSCR",
      "formula": "R9069 / MAX(R9068, 0.0001) * R9073 * F8",
      "type": "stock",
      "_moduleId": "M1",
      "_moduleOutputKey": "period_dscr"
    },
    {
      "id": 9072,
      "groupId": 56,
      "name": "Cumulative Principal",
      "formula": "CUMSUM(R9067)",
      "type": "stock",
      "_moduleId": "M1",
      "_moduleOutputKey": "cumulative_principal"
    },
    {
      "id": 9073,
      "groupId": 56,
      "name": "Payment Period Flag",
      "formula": "(T.QE + F8.End - T.QE * F8.End) * F8",
      "type": "stock",
      "_moduleId": "M1",
      "_moduleOutputKey": "payment_period_flag"
    },
    {
      "id": 9080,
      "groupId": 57,
      "name": "DSRF Establishment Fee",
      "formula": "M8.1 * C1.51 / 100 * F2.Start",
      "type": "flow",
      "_moduleId": "M8",
      "_moduleOutputKey": "establishment_fee"
    },
    {
      "id": 9081,
      "groupId": 57,
      "name": "DSRF Commitment Fee",
      "formula": "M8.1 * M8.3 / 100 * C1.52 / 100 / T.QiY * T.QE * F2",
      "type": "flow",
      "_moduleId": "M8",
      "_moduleOutputKey": "commitment_fee"
    },
    {
      "id": 9082,
      "groupId": 57,
      "name": "Total DSRF Fees",
      "formula": "R9080 + R9081 + M8.2",
      "type": "flow",
      "_moduleId": "M8",
      "_moduleOutputKey": "total_dsrf_fees"
    },
    {
      "id": 9083,
      "groupId": 57,
      "name": "Total DSRF Fees (Cumulative)",
      "formula": "CUMSUM(R9082)",
      "type": "stock",
      "_moduleId": "M8",
      "_moduleOutputKey": "total_dsrf_fees_cumulative"
    },
    {
      "id": 9084,
      "groupId": 57,
      "name": "DS + DSRF Fees",
      "formula": "ABS(R9068) + R9082",
      "type": "flow",
      "_moduleId": "M8",
      "_moduleOutputKey": "ds_plus_dsrf"
    },
    {
      "id": 9085,
      "groupId": 57,
      "name": "Adjusted DSCR",
      "formula": "(R208 + R209) / MAX(R9084, 0.0001) * F8",
      "type": "stock",
      "_moduleId": "M8",
      "_moduleOutputKey": "adjusted_dscr"
    },
    {
      "id": 210,
      "groupId": 58,
      "name": "NPV (FCFF)",
      "formula": "SUMPRODUCT(R46, R51)",
      "description": "Net Present Value of Free Cash Flow to Firm",
      "type": "stock"
    },
    {
      "id": 211,
      "groupId": 58,
      "name": "NPV (FCFE)",
      "formula": "SUMPRODUCT(R49, R51)",
      "description": "Net Present Value of Free Cash Flow to Equity",
      "type": "stock"
    },
    {
      "id": 212,
      "groupId": 58,
      "name": "Equity Cumulative CF",
      "formula": "CUMSUM(R137)",
      "description": "Running total of equity cash flows for payback tracking",
      "type": "stock"
    },
    {
      "id": 213,
      "groupId": 58,
      "name": "Equity Payback Flag",
      "formula": "(R212 > 0) * (SHIFT(R212, 1) <= 0)",
      "description": "1 in the period when equity cumulative CF first turns positive",
      "type": "stock"
    },
    {
      "id": 214,
      "groupId": 58,
      "name": "Equity Payback Period",
      "formula": "R213 * CUMSUM(1)",
      "description": "Period number of equity payback (0 if no payback yet)",
      "type": "stock"
    },
    {
      "id": 215,
      "groupId": 24,
      "name": "Cumulative CFADS",
      "formula": "CUMSUM(R207 * F8)",
      "description": "Running total of CFADS during debt service period",
      "type": "stock"
    },
    {
      "id": 216,
      "groupId": 24,
      "name": "Cumulative Debt Service",
      "formula": "CUMSUM(R73 * F8)",
      "description": "Running total of debt service during debt service period",
      "type": "stock"
    },
    {
      "id": 217,
      "groupId": 24,
      "name": "ADSCR (Average)",
      "formula": "R215 / MAX(R216, 0.0001) * F8",
      "description": "Average DSCR: cumulative CFADS / cumulative debt service. Measures overall project debt coverage.",
      "type": "stock"
    },
    {
      "id": 218,
      "groupId": 24,
      "name": "LLCR",
      "formula": "(SUMPRODUCT(R207, R51) - SUMPRODUCT(R207 * (1 - F8), R51)) / MAX(R74, 0.0001)",
      "description": "Loan Life Cover Ratio: NPV of remaining CFADS (during debt period) / outstanding debt",
      "type": "stock"
    },
    {
      "id": 220,
      "groupId": 29,
      "name": "O&M MSA",
      "formula": "S1.14 * I2 * F2",
      "description": "Operations & Maintenance MSA cost (CPI-indexed, ops only)"
    },
    {
      "id": 221,
      "groupId": 29,
      "name": "Land Lease",
      "formula": "S1.15 * I2 * F2",
      "description": "Land lease payments (CPI-indexed, ops only)"
    },
    {
      "id": 222,
      "groupId": 29,
      "name": "Connection Opex",
      "formula": "S1.16 * I2 * F2",
      "description": "Network connection charges (CPI-indexed, ops only)"
    },
    {
      "id": 223,
      "groupId": 29,
      "name": "SPV Costs",
      "formula": "S1.17 * I2 * F2",
      "description": "Special purpose vehicle administration costs (CPI-indexed, ops only)"
    },
    {
      "id": 224,
      "groupId": 29,
      "name": "Asset Management Fees",
      "formula": "S1.18 * I2 * F2",
      "description": "Asset management fee (CPI-indexed, ops only)"
    },
    {
      "id": 225,
      "groupId": 29,
      "name": "Maintenance Capex & O&M Charges",
      "formula": "S1.19 * I2 * F2",
      "description": "Maintenance capex and additional service O&M charges (CPI-indexed, ops only)"
    },
    {
      "id": 226,
      "groupId": 29,
      "name": "Insurance (yrs 1-2)",
      "formula": "S1.20 * I2 * F2",
      "description": "Insurance premiums for first 2 years of operations (CPI-indexed)"
    },
    {
      "id": 227,
      "groupId": 29,
      "name": "Insurance (yrs 3+)",
      "formula": "S1.21 * I2 * F2",
      "description": "Insurance premiums from year 3 onwards (CPI-indexed)"
    },
    {
      "id": 228,
      "groupId": 29,
      "name": "Total OPEX Breakdown",
      "formula": "R220 + R221 + R222 + R223 + R224 + R225 + R226 + R227",
      "description": "Sum of all OPEX components (should reconcile to -R9, i.e. S1 * I2)"
    },
    {
      "id": 300,
      "tabId": 7,
      "groupId": 60,
      "name": "Contracted Revenue",
      "formula": "R4"
    },
    {
      "id": 301,
      "tabId": 7,
      "groupId": 60,
      "name": "Merchant Revenue",
      "formula": "R7"
    },
    {
      "id": 302,
      "tabId": 7,
      "groupId": 60,
      "name": "Total Revenue",
      "formula": "R8"
    },
    {
      "id": 303,
      "tabId": 7,
      "groupId": 60,
      "name": "OPEX",
      "formula": "R9"
    },
    {
      "id": 304,
      "tabId": 7,
      "groupId": 60,
      "name": "EBITDA",
      "formula": "R13"
    },
    {
      "id": 305,
      "tabId": 7,
      "groupId": 60,
      "name": "Working Capital Adj",
      "formula": "-R98"
    },
    {
      "id": 306,
      "tabId": 7,
      "groupId": 60,
      "name": "Operating Cash Flows",
      "formula": "R22"
    },
    {
      "id": 310,
      "tabId": 7,
      "groupId": 60,
      "name": "Total Capex",
      "formula": "-R3 * F1",
      "description": "Total capex incl contingency (per period)"
    },
    {
      "id": 313,
      "tabId": 7,
      "groupId": 60,
      "name": "IDC: Senior Debt",
      "formula": "-R9022"
    },
    {
      "id": 314,
      "tabId": 7,
      "groupId": 60,
      "name": "Upfront Fees: Senior Debt",
      "formula": "-R144"
    },
    {
      "id": 315,
      "tabId": 7,
      "groupId": 60,
      "name": "Upfront Fees: DSRF",
      "formula": "-R9080 * F1"
    },
    {
      "id": 316,
      "tabId": 7,
      "groupId": 60,
      "name": "Commitment Fees: Senior Debt",
      "formula": "-R146"
    },
    {
      "id": 317,
      "tabId": 7,
      "groupId": 60,
      "name": "Commitment Fees: DSRF",
      "formula": "-R9081 * F1"
    },
    {
      "id": 318,
      "tabId": 7,
      "groupId": 60,
      "name": "Agency Fee (Construction)",
      "formula": "-S3 * I2 * F1"
    },
    {
      "id": 319,
      "tabId": 7,
      "groupId": 60,
      "name": "MRA: Initial Funding",
      "formula": "-R9033"
    },
    {
      "id": 320,
      "tabId": 7,
      "groupId": 60,
      "name": "GST Paid",
      "formula": "R24"
    },
    {
      "id": 321,
      "tabId": 7,
      "groupId": 60,
      "name": "Total Capital Expenditure",
      "formula": "R310 + R313 + R314 + R315 + R316 + R317 + R318 + R319 + R320",
      "description": "All construction uses: capex + IDC + fees + MRA + GST"
    },
    {
      "id": 325,
      "tabId": 7,
      "groupId": 60,
      "name": "GST Received (Funding)",
      "formula": "R9013 * F1"
    },
    {
      "id": 326,
      "tabId": 7,
      "groupId": 60,
      "name": "Committed Equity",
      "formula": "R9021"
    },
    {
      "id": 327,
      "tabId": 7,
      "groupId": 60,
      "name": "Senior Debt",
      "formula": "R9020"
    },
    {
      "id": 328,
      "tabId": 7,
      "groupId": 60,
      "name": "Total Funding",
      "formula": "R325 + R326 + R327",
      "description": "GST received + equity drawdown + debt drawdown"
    },
    {
      "id": 330,
      "tabId": 7,
      "groupId": 60,
      "name": "Cash Flow After Funding",
      "formula": "R306 + R321 + R328"
    },
    {
      "id": 331,
      "tabId": 7,
      "groupId": 60,
      "name": "Interest Income",
      "formula": "R151"
    },
    {
      "id": 332,
      "tabId": 7,
      "groupId": 60,
      "name": "GST Received (Ops)",
      "formula": "R25"
    },
    {
      "id": 333,
      "tabId": 7,
      "groupId": 60,
      "name": "Tax",
      "formula": "R18"
    },
    {
      "id": 335,
      "tabId": 7,
      "groupId": 60,
      "name": "MRA Release",
      "formula": "R9035"
    },
    {
      "id": 336,
      "tabId": 7,
      "groupId": 60,
      "name": "Maintenance Capex",
      "formula": "-R9034"
    },
    {
      "id": 340,
      "tabId": 7,
      "groupId": 60,
      "name": "Interest Expense",
      "formula": "R16"
    },
    {
      "id": 341,
      "tabId": 7,
      "groupId": 60,
      "name": "Principal Repayment",
      "formula": "R31"
    },
    {
      "id": 342,
      "tabId": 7,
      "groupId": 60,
      "name": "Agency Fee (Ops)",
      "formula": "R174"
    },
    {
      "id": 343,
      "tabId": 7,
      "groupId": 60,
      "name": "Total Debt Service",
      "formula": "R340 + R341 + R342"
    },
    {
      "id": 344,
      "tabId": 7,
      "groupId": 60,
      "name": "DSRF Fees",
      "formula": "R153"
    },
    {
      "id": 350,
      "tabId": 7,
      "groupId": 60,
      "name": "Dividends",
      "formula": "R155"
    },
    {
      "id": 351,
      "tabId": 7,
      "groupId": 60,
      "name": "Share Capital Repayment",
      "formula": "R154"
    },
    {
      "id": 352,
      "tabId": 7,
      "groupId": 60,
      "name": "Net Cash Flow",
      "formula": "R40"
    },
    {
      "id": 353,
      "tabId": 7,
      "groupId": 60,
      "name": "Cash Balance c/f",
      "formula": "R42",
      "type": "stock"
    },
    {
      "id": 360,
      "tabId": 7,
      "groupId": 61,
      "name": "Revenue Accrued",
      "formula": "R8"
    },
    {
      "id": 361,
      "tabId": 7,
      "groupId": 61,
      "name": "OPEX Accrued",
      "formula": "R9"
    },
    {
      "id": 362,
      "tabId": 7,
      "groupId": 61,
      "name": "EBITDA",
      "formula": "R13"
    },
    {
      "id": 363,
      "tabId": 7,
      "groupId": 61,
      "name": "Depreciation",
      "formula": "R14"
    },
    {
      "id": 364,
      "tabId": 7,
      "groupId": 61,
      "name": "EBIT",
      "formula": "R15"
    },
    {
      "id": 365,
      "tabId": 7,
      "groupId": 61,
      "name": "Interest Income",
      "formula": "R151"
    },
    {
      "id": 366,
      "tabId": 7,
      "groupId": 61,
      "name": "Interest Expense",
      "formula": "R16"
    },
    {
      "id": 367,
      "tabId": 7,
      "groupId": 61,
      "name": "DSRF Fees",
      "formula": "R153"
    },
    {
      "id": 368,
      "tabId": 7,
      "groupId": 61,
      "name": "Agency Fee",
      "formula": "R174"
    },
    {
      "id": 369,
      "tabId": 7,
      "groupId": 61,
      "name": "EBT",
      "formula": "R17"
    },
    {
      "id": 370,
      "tabId": 7,
      "groupId": 61,
      "name": "Tax",
      "formula": "R18"
    },
    {
      "id": 371,
      "tabId": 7,
      "groupId": 61,
      "name": "NPAT",
      "formula": "R19"
    },
    {
      "id": 9099,
      "groupId": 52,
      "name": "Construction Funding: Equity Target (ex-IDC)",
      "formula": "MAXVAL(R60) - M1.1",
      "type": "stock",
      "_moduleId": "M4",
      "_moduleOutputKey": "equity_target",
      "description": "Equity target: total capex minus sized debt (both based on R60)"
    }
  ],
  "modules": [
    {
      "id": 1769253473397,
      "templateId": "iterative_debt_sizing",
      "name": "Operation Debt",
      "description": "Binary search to find optimal debt with DSCR-sculpted repayments",
      "category": "financing",
      "inputs": {
        "contractedCfadsRef": "R208",
        "contractedDSCR": "C1.25",
        "merchantCfadsRef": "R209",
        "merchantDSCR": "C1.26",
        "debtFlagRef": "F8",
        "totalFundingRef": "R60",
        "maxGearingPct": "C1.19",
        "interestRatePct": "R172",
        "tenorYears": "C1.27",
        "debtPeriod": "Q",
        "tolerance": 0.1,
        "maxIterations": 50
      },
      "outputs": [
        "sized_debt"
      ],
      "solvedAt": 1769461750580,
      "partiallyConverted": true
    },
    {
      "id": 1769317033954,
      "templateId": "depreciation_amortization",
      "name": "Depreciation & Amortization",
      "description": "CUMSUM-based ledger pattern - no circular dependencies",
      "category": "accounting",
      "inputs": {
        "additionsRef": "R203",
        "opsFlagRef": "F2",
        "lifeYears": "C1.24",
        "method": "straight_line",
        "dbMultiplier": 2
      },
      "outputs": [],
      "converted": true,
      "calcIds": [
        9001,
        9002,
        9003,
        9004,
        9005
      ],
      "fullyConverted": true
    },
    {
      "id": 1769320996781,
      "templateId": "gst_receivable",
      "name": "GST Paid/Received",
      "description": "GST ledger with configurable receipt delay using CUMSUM pattern",
      "category": "accounting",
      "inputs": {
        "gstBaseRef": "R112",
        "activeFlagRef": "F1",
        "gstRatePct": "C1.15",
        "receiptDelayMonths": "C1.31",
        "constructionFlagRef": "F1",
        "operationsFlagRef": "F2"
      },
      "outputs": [],
      "converted": true,
      "calcIds": [
        9006,
        9007,
        9008,
        9009,
        9010,
        9011,
        9012,
        9013,
        9014
      ],
      "fullyConverted": true
    },
    {
      "id": 1769323861808,
      "templateId": "construction_funding",
      "name": "Construction Funding",
      "description": "Construction funding waterfall with IDC equity-funded",
      "category": "financing",
      "inputs": {
        "constructionCostsRef": "R60",
        "gstPaidRef": "R61",
        "feesRef": "R173",
        "sizedDebtRef": "M1.1",
        "gearingCapPct": "C1.19",
        "interestRatePct": "R171",
        "drawdownMethod": "equity_first",
        "constructionFlagRef": "F1"
      },
      "outputs": [],
      "solvedAt": null,
      "converted": true,
      "calcIds": [
        9015,
        9016,
        9017,
        9018,
        9019,
        9020,
        9021,
        9022,
        9023,
        9024
      ],
      "fullyConverted": true
    },
    {
      "id": 1769400000000,
      "templateId": "tax_losses",
      "name": "Tax & Tax Losses",
      "description": "Tax calculation with loss carry-forward using CUMSUM pattern",
      "category": "accounting",
      "inputs": {
        "taxableIncomeRef": "R17",
        "opsFlagRef": "F2",
        "taxRatePct": "C1.11"
      },
      "outputs": [],
      "solvedAt": null,
      "enabled": false,
      "converted": true,
      "calcIds": [
        9025,
        9026,
        9027,
        9028,
        9029,
        9030,
        9031
      ],
      "fullyConverted": true
    },
    {
      "id": 1769500000000,
      "templateId": "reserve_account",
      "name": "MRA (Maintenance Reserve)",
      "description": "MRA funded at construction end, draws for maintenance, releases at maintenance end",
      "category": "financing",
      "inputs": {
        "accountName": "MRA",
        "fundingAmountRef": "C1.17",
        "fundingFlagRef": "F1.End",
        "drawdownRef": "S1.19",
        "drawdownFlagRef": "F12",
        "releaseFlagRef": "F12.End"
      },
      "outputs": [],
      "converted": true,
      "calcIds": [
        9032,
        9033,
        9034,
        9035,
        9036
      ],
      "fullyConverted": true
    },
    {
      "id": 1769600000000,
      "templateId": "distributions",
      "name": "Distributions",
      "description": "Shareholder distributions waterfall with RE test, lock-up covenants, and share capital repayment",
      "category": "financing",
      "inputs": {
        "availableCashRef": "R170",
        "npatRef": "R19",
        "equityContributedRef": "R9017",
        "minCashReserve": "C1.28",
        "opsFlagRef": "F2",
        "withholdingTaxPct": 0,
        "lockupActive": true,
        "lockupReleasePeriods": "C1.49",
        "dscrTestActive": true,
        "dscrRef": "R9071",
        "dscrThreshold": "C1.47",
        "adscrTestActive": true,
        "cfadsRef": "R205",
        "debtServiceRef": "R9068",
        "adscrThreshold": "C1.48",
        "dsraTestActive": false,
        "dsraBalanceRef": "",
        "dsraTargetRef": "",
        "quarterEndFlagRef": "T.QE"
      },
      "outputs": [],
      "enabled": true,
      "converted": true,
      "calcIds": [
        9037,
        9038,
        9039,
        9040,
        9041,
        9042,
        9043,
        9044,
        9045,
        9046,
        9047,
        9048,
        9049,
        9050,
        9051,
        9052,
        9053,
        9054,
        9055,
        9056,
        9057,
        9058,
        9059
      ],
      "fullyConverted": true
    },
    {
      "id": 1769700000000,
      "templateId": "dsrf",
      "name": "DSRF (Debt Service Reserve Facility)",
      "description": "Standby facility guaranteeing debt service with refinancing schedule",
      "category": "financing",
      "inputs": {
        "dsrfActiveRef": "C1.50",
        "debtServiceRef": "R9068",
        "operationsFlagRef": "F2",
        "establishmentFeePctRef": "C1.51",
        "commitmentFeePctOfMarginRef": "C1.52",
        "baseMarginPctRef": "C1.53",
        "facilityMonthsRef": "C1.54",
        "refinancingSchedule": [
          {
            "active": true,
            "monthIndex": 60,
            "feePct": 1,
            "marginPct": 1.7
          },
          {
            "active": true,
            "monthIndex": 120,
            "feePct": 1,
            "marginPct": 1.7
          },
          {
            "active": true,
            "monthIndex": 180,
            "feePct": 1,
            "marginPct": 1.7
          },
          {
            "active": true,
            "monthIndex": 240,
            "feePct": 1,
            "marginPct": 1.7
          },
          {
            "active": false,
            "monthIndex": 0,
            "feePct": 0,
            "marginPct": 0
          }
        ]
      },
      "outputs": [
        "facility_limit",
        "refi_fees",
        "effective_margin"
      ],
      "enabled": true,
      "partiallyConverted": true
    }
  ],
  "moduleTemplates": [
    {
      "id": "construction_funding",
      "name": "Construction Funding",
      "description": "Construction funding waterfall with IDC equity-funded",
      "category": "financing",
      "inputs": [
        {
          "key": "constructionCostsRef",
          "label": "Construction Costs (cumulative)",
          "type": "reference",
          "default": "R60"
        },
        {
          "key": "gstPaidRef",
          "label": "GST Paid (cumulative)",
          "type": "reference",
          "default": "R61"
        },
        {
          "key": "feesRef",
          "label": "Fees/Other Uses (cumulative)",
          "type": "reference",
          "default": ""
        },
        {
          "key": "sizedDebtRef",
          "label": "Sized Debt (from Debt Module)",
          "type": "reference",
          "default": "M1.1"
        },
        {
          "key": "gearingCapPct",
          "label": "Gearing Cap (%)",
          "type": "number",
          "default": 65
        },
        {
          "key": "interestRatePct",
          "label": "IDC Interest Rate (%)",
          "type": "number",
          "default": 5
        },
        {
          "key": "drawdownMethod",
          "label": "Drawdown Method",
          "type": "select",
          "options": [
            {
              "value": "prorata",
              "label": "Pro-rata"
            },
            {
              "value": "equity_first",
              "label": "Equity First"
            }
          ],
          "default": "prorata"
        },
        {
          "key": "constructionFlagRef",
          "label": "Construction Flag",
          "type": "reference",
          "default": "F1"
        }
      ],
      "outputs": [
        "total_uses_incl_idc",
        "senior_debt",
        "equity",
        "gearing_pct",
        "cumulative_idc",
        "debt_drawdown",
        "equity_drawdown",
        "idc",
        "total_uses_ex_idc"
      ]
    },
    {
      "id": "reserve_account",
      "name": "Reserve Account",
      "description": "Reserve account (MRA/DSRA) with funding and drawdown using CUMSUM pattern",
      "category": "financing",
      "inputs": [
        {
          "key": "fundingAmountRef",
          "label": "Funding Amount",
          "type": "reference",
          "default": ""
        },
        {
          "key": "fundingFlagRef",
          "label": "Funding Flag (e.g., F1.End)",
          "type": "reference",
          "default": "F1.End"
        },
        {
          "key": "drawdownRef",
          "label": "Drawdown Amount (optional)",
          "type": "reference",
          "default": ""
        },
        {
          "key": "drawdownFlagRef",
          "label": "Drawdown Flag (e.g., F2)",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "releaseFlagRef",
          "label": "Release Flag (e.g., F2.End)",
          "type": "reference",
          "default": "F2.End"
        }
      ],
      "outputs": [
        "opening",
        "funding",
        "drawdown",
        "release",
        "closing"
      ]
    },
    {
      "id": "gst_receivable",
      "name": "GST Paid/Received",
      "description": "GST ledger with configurable receipt delay using CUMSUM pattern",
      "category": "accounting",
      "inputs": [
        {
          "key": "gstBaseRef",
          "label": "GST Base Amount (e.g., R112)",
          "type": "reference",
          "default": "R112"
        },
        {
          "key": "activeFlagRef",
          "label": "Active Period Flag",
          "type": "reference",
          "default": "F1"
        },
        {
          "key": "gstRatePct",
          "label": "GST Rate (%)",
          "type": "number",
          "default": 10
        },
        {
          "key": "receiptDelayMonths",
          "label": "Receipt Delay (months)",
          "type": "number",
          "default": 1
        }
      ],
      "outputs": [
        "gst_base",
        "gst_amount",
        "gst_paid",
        "receivable_opening",
        "gst_received",
        "receivable_closing",
        "net_gst_cashflow"
      ]
    },
    {
      "id": "tax_losses",
      "name": "Tax & Tax Losses",
      "description": "Tax calculation with loss carry-forward using CUMSUM pattern",
      "category": "accounting",
      "inputs": [
        {
          "key": "taxableIncomeRef",
          "label": "Taxable Income Before Losses",
          "type": "reference",
          "default": ""
        },
        {
          "key": "opsFlagRef",
          "label": "Operations Flag",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "taxRatePct",
          "label": "Tax Rate (%)",
          "type": "number",
          "default": 30
        }
      ],
      "outputs": [
        "taxable_income_before_losses",
        "losses_opening",
        "losses_generated",
        "losses_utilised",
        "losses_closing",
        "net_taxable_income",
        "tax_payable"
      ]
    },
    {
      "id": "depreciation_amortization",
      "name": "Depreciation & Amortization",
      "description": "CUMSUM-based ledger pattern - no circular dependencies",
      "category": "accounting",
      "inputs": [
        {
          "key": "additionsRef",
          "label": "Capital Additions Reference",
          "type": "reference",
          "default": "V1"
        },
        {
          "key": "opsFlagRef",
          "label": "Operations Flag",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "lifeYears",
          "label": "Useful Life (years)",
          "type": "number",
          "default": 15
        },
        {
          "key": "method",
          "label": "Depreciation Method",
          "type": "select",
          "options": [
            {
              "value": "straight_line",
              "label": "Straight Line"
            },
            {
              "value": "declining_balance",
              "label": "Declining Balance"
            }
          ],
          "default": "straight_line"
        },
        {
          "key": "dbMultiplier",
          "label": "DB Multiplier",
          "type": "select",
          "options": [
            {
              "value": 2,
              "label": "Double (2x)"
            },
            {
              "value": 1.5,
              "label": "150% (1.5x)"
            },
            {
              "value": 1,
              "label": "100% (1x)"
            }
          ],
          "default": 2
        }
      ],
      "outputs": [
        "opening",
        "addition",
        "depreciation",
        "accumulated",
        "closing"
      ]
    },
    {
      "id": "iterative_debt_sizing",
      "name": "Iterative Debt Sizing (DSCR Sculpted)",
      "description": "Binary search to find optimal debt with DSCR-sculpted repayments. Supports separate contracted/merchant DSCRs.",
      "category": "financing",
      "inputs": [
        {
          "key": "contractedCfadsRef",
          "label": "Contracted CFADS",
          "type": "reference",
          "default": "R115"
        },
        {
          "key": "contractedDSCR",
          "label": "Contracted DSCR",
          "type": "number_or_ref",
          "default": "C1.25"
        },
        {
          "key": "merchantCfadsRef",
          "label": "Merchant CFADS",
          "type": "reference",
          "default": "R116"
        },
        {
          "key": "merchantDSCR",
          "label": "Merchant DSCR",
          "type": "number_or_ref",
          "default": "C1.26"
        },
        {
          "key": "debtFlagRef",
          "label": "Debt Service Flag",
          "type": "reference",
          "default": "F8"
        },
        {
          "key": "totalFundingRef",
          "label": "Total Capex (ex-IDC)",
          "type": "reference",
          "default": "R60"
        },
        {
          "key": "maxGearingPct",
          "label": "Max Gearing (%)",
          "type": "number",
          "default": 65
        },
        {
          "key": "interestRatePct",
          "label": "Interest Rate (%)",
          "type": "number",
          "default": 5
        },
        {
          "key": "tenorYears",
          "label": "Debt Tenor (years)",
          "type": "number",
          "default": 18
        },
        {
          "key": "debtPeriod",
          "label": "Debt Service Period",
          "type": "select",
          "options": [
            {
              "value": "M",
              "label": "Monthly"
            },
            {
              "value": "Q",
              "label": "Quarterly"
            },
            {
              "value": "Y",
              "label": "Yearly"
            }
          ],
          "default": "Q"
        },
        {
          "key": "tolerance",
          "label": "Tolerance ($M)",
          "type": "number",
          "default": 0.1
        },
        {
          "key": "maxIterations",
          "label": "Max Iterations",
          "type": "number",
          "default": 50
        }
      ],
      "outputs": [
        "sized_debt",
        "opening_balance",
        "interest_payment",
        "principal_payment",
        "debt_service",
        "closing_balance",
        "period_dscr",
        "cumulative_principal"
      ]
    },
    {
      "id": "distributions",
      "name": "Distributions",
      "description": "Shareholder distributions waterfall with RE test, lock-up covenants, and share capital repayment",
      "category": "financing",
      "inputs": [
        {
          "key": "availableCashRef",
          "label": "Available Cashflow (pre-dist)",
          "type": "reference",
          "default": "R170"
        },
        {
          "key": "npatRef",
          "label": "NPAT",
          "type": "reference",
          "default": "R19"
        },
        {
          "key": "equityContributedRef",
          "label": "Equity Contributed",
          "type": "reference",
          "default": "M4.3"
        },
        {
          "key": "minCashReserve",
          "label": "Minimum Cash Reserve",
          "type": "number_or_ref",
          "default": 0
        },
        {
          "key": "opsFlagRef",
          "label": "Operations Flag",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "withholdingTaxPct",
          "label": "Withholding Tax %",
          "type": "number_or_ref",
          "default": 0
        },
        {
          "key": "lockupActive",
          "label": "Lock-up Active",
          "type": "boolean",
          "default": true
        },
        {
          "key": "lockupReleasePeriods",
          "label": "Release After (Qtrs)",
          "type": "number_or_ref",
          "default": 2
        },
        {
          "key": "dscrTestActive",
          "label": "DSCR Test Active",
          "type": "boolean",
          "default": true
        },
        {
          "key": "dscrRef",
          "label": "DSCR (periodic)",
          "type": "reference",
          "default": "M1.7"
        },
        {
          "key": "dscrThreshold",
          "label": "DSCR Threshold",
          "type": "number_or_ref",
          "default": 1.15
        },
        {
          "key": "adscrTestActive",
          "label": "Historical ADSCR Test Active",
          "type": "boolean",
          "default": true
        },
        {
          "key": "cfadsRef",
          "label": "Total CFADS",
          "type": "reference",
          "default": "R205"
        },
        {
          "key": "debtServiceRef",
          "label": "Total Debt Service",
          "type": "reference",
          "default": "M1.5"
        },
        {
          "key": "adscrThreshold",
          "label": "ADSCR Threshold",
          "type": "number_or_ref",
          "default": 1.15
        },
        {
          "key": "dsraTestActive",
          "label": "DSRA Fully Funded Test",
          "type": "boolean",
          "default": false
        },
        {
          "key": "dsraBalanceRef",
          "label": "DSRA Balance",
          "type": "reference",
          "default": ""
        },
        {
          "key": "dsraTargetRef",
          "label": "DSRA Target",
          "type": "reference",
          "default": ""
        },
        {
          "key": "quarterEndFlagRef",
          "label": "Quarter End Flag",
          "type": "reference",
          "default": "T.QE"
        }
      ],
      "outputs": [
        "cash_available",
        "re_opening",
        "re_npat",
        "re_test",
        "npat_test",
        "dividend_paid",
        "re_movement",
        "re_closing",
        "sc_opening",
        "sc_cash_available",
        "sc_repayment",
        "sc_closing",
        "total_distributions",
        "withholding_tax",
        "net_to_equity",
        "dscr_test",
        "adscr_test",
        "dsra_test",
        "all_tests_pass",
        "consec_pass_qtrs",
        "lockup_active"
      ]
    },
    {
      "id": "dsrf",
      "name": "DSRF (Debt Service Reserve Facility)",
      "description": "Standby facility guaranteeing debt service with refinancing schedule",
      "category": "financing",
      "inputs": [
        {
          "key": "dsrfActiveRef",
          "label": "DSRF Active",
          "type": "reference",
          "default": "C1.50"
        },
        {
          "key": "debtServiceRef",
          "label": "Total Debt Service",
          "type": "reference",
          "default": "R178"
        },
        {
          "key": "operationsFlagRef",
          "label": "Operations Flag",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "establishmentFeePctRef",
          "label": "Establishment Fee (%)",
          "type": "number_or_ref",
          "default": "C1.51"
        },
        {
          "key": "commitmentFeePctOfMarginRef",
          "label": "Commitment Fee (% of Margin)",
          "type": "number_or_ref",
          "default": "C1.52"
        },
        {
          "key": "baseMarginPctRef",
          "label": "Base Margin (%)",
          "type": "number_or_ref",
          "default": "C1.53"
        },
        {
          "key": "facilityMonthsRef",
          "label": "Facility Months of DS",
          "type": "number_or_ref",
          "default": "C1.54"
        },
        {
          "key": "refinancingSchedule",
          "label": "Refinancing Schedule",
          "type": "array",
          "default": []
        }
      ],
      "outputs": [
        "facility_limit",
        "establishment_fee",
        "commitment_fee",
        "refi_fees",
        "effective_margin",
        "total_dsrf_fees",
        "total_dsrf_fees_cumulative",
        "ds_plus_dsrf",
        "adjusted_dscr"
      ]
    }
  ],
  "_mRefMap": {
    "M2.1": "R9001",
    "M2.2": "R9002",
    "M2.3": "R9003",
    "M2.4": "R9004",
    "M2.5": "R9005",
    "M3.1": "R9006",
    "M3.2": "R9007",
    "M3.3": "R9008",
    "M3.4": "R9009",
    "M3.5": "R9010",
    "M3.6": "R9011",
    "M3.7": "R9012",
    "M3.8": "R9013",
    "M3.9": "R9014",
    "M4.1": "R9015",
    "M4.2": "R9016",
    "M4.3": "R9017",
    "M4.4": "R9018",
    "M4.5": "R9019",
    "M4.6": "R9020",
    "M4.7": "R9021",
    "M4.8": "R9022",
    "M4.9": "R9023",
    "M4.10": "R9024",
    "M5.1": "R9025",
    "M5.2": "R9026",
    "M5.3": "R9027",
    "M5.4": "R9028",
    "M5.5": "R9029",
    "M5.6": "R9030",
    "M5.7": "R9031",
    "M6.1": "R9032",
    "M6.2": "R9033",
    "M6.3": "R9034",
    "M6.4": "R9035",
    "M6.5": "R9036",
    "M7.1": "R9037",
    "M7.2": "R9038",
    "M7.3": "R9039",
    "M7.4": "R9040",
    "M7.5": "R9041",
    "M7.6": "R9042",
    "M7.7": "R9043",
    "M7.8": "R9044",
    "M7.9": "R9045",
    "M7.10": "R9046",
    "M7.11": "R9047",
    "M7.12": "R9048",
    "M7.13": "R9049",
    "M7.14": "R9050",
    "M7.15": "R9051",
    "M7.16": "R9052",
    "M7.17": "R9053",
    "M7.18": "R9054",
    "M7.19": "R9055",
    "M7.20": "R9056",
    "M7.21": "R9057",
    "M7.22": "R9058",
    "M7.23": "R9059",
    "M1.2": "R9063",
    "M1.3": "R9066",
    "M1.4": "R9067",
    "M1.5": "R9068",
    "M1.6": "R9070",
    "M1.7": "R9071",
    "M1.8": "R9072",
    "M8.6": "R9082",
    "M8.7": "R9083",
    "M8.8": "R9084",
    "M8.9": "R9085"
  }
}