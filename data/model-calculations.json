{
  "_description": "Model structure - formulas and relationships only",
  "calculationsTabs": [
    {
      "id": 1,
      "name": "P&L"
    },
    {
      "id": 3,
      "name": "Cashflow"
    },
    {
      "id": 4,
      "name": "Valuation"
    }
  ],
  "calculationsGroups": [
    {
      "id": 4,
      "tabId": 1,
      "name": "Profitability",
      "startYear": 2028,
      "startMonth": 10,
      "endYear": 2053,
      "endMonth": 9
    },
    {
      "id": 10,
      "tabId": 3,
      "name": "Operating CF"
    },
    {
      "id": 11,
      "tabId": 3,
      "name": "Investing CF"
    },
    {
      "id": 12,
      "tabId": 3,
      "name": "Financing CF"
    },
    {
      "id": 13,
      "tabId": 3,
      "name": "Cash Position"
    },
    {
      "id": 14,
      "tabId": 3,
      "name": "Construction S&U"
    },
    {
      "id": 24,
      "tabId": 3,
      "name": "Covenants"
    },
    {
      "id": 15,
      "tabId": 3,
      "name": "Operations Debt"
    },
    {
      "id": 16,
      "tabId": 1,
      "name": "D&A"
    },
    {
      "id": 18,
      "tabId": 3,
      "name": "Working Capital"
    },
    {
      "id": 19,
      "tabId": 3,
      "name": "Tax"
    },
    {
      "id": 20,
      "tabId": 4,
      "name": "Free Cash Flow"
    },
    {
      "id": 21,
      "tabId": 4,
      "name": "Discount Factors"
    },
    {
      "id": 23,
      "tabId": "all",
      "name": "Calculations"
    },
    {
      "id": 25,
      "tabId": 3,
      "name": "Dividends"
    },
    {
      "id": 26,
      "tabId": 4,
      "name": "Equity IRR"
    }
  ],
  "calculations": [
    {
      "id": 119,
      "name": "Model Period",
      "formula": "CUMSUM(1)",
      "description": "Period counter (1, 2, 3, ...)",
      "type": "stock"
    },
    {
      "id": 120,
      "name": "Ops Period",
      "formula": "CUMSUM(F2)",
      "description": "Operations period counter (0 until ops, then 1, 2, 3, ...)",
      "type": "stock"
    },
    {
      "id": 3,
      "name": "Capex + Cont",
      "formula": "V1 * (1 + C1.23 / 100)",
      "description": ""
    },
    {
      "id": 112,
      "name": "Capex to Apply GST",
      "formula": "V1 - V1.1 - V1.9",
      "description": "CAPEX minus EPC-BESS (import) minus Land Transaction (stamp duty) - both GST-free"
    },
    {
      "id": 4,
      "name": "Tolling Revenue",
      "formula": "C1.10 * C1.1 * T.HiY / T.MiY / 10^6 * F6 * I2",
      "description": ""
    },
    {
      "id": 5,
      "name": "FCAS Revenue",
      "formula": "L1.2 * C1.1 / T.MiY / 10^6 * F7 * I2",
      "description": ""
    },
    {
      "id": 6,
      "name": "Arb Revenue",
      "formula": "L1.1 * C1.1 / 10^6 / T.MiY * F7 * R12 * I2",
      "description": "L1.1 is annual, divide by 12 for monthly"
    },
    {
      "id": 7,
      "name": "Merchant Revenue",
      "formula": "R5 + R6",
      "description": ""
    },
    {
      "id": 8,
      "tabId": 1,
      "groupId": 4,
      "name": "Total Revenue",
      "formula": "R4 + R7",
      "description": "Revenue group sum"
    },
    {
      "id": 9,
      "tabId": 1,
      "groupId": 4,
      "name": "Total OPEX (Nominal)",
      "formula": "-S1 * I2",
      "description": "OPEX group sum"
    },
    {
      "id": 10,
      "tabId": 1,
      "groupId": 4,
      "name": "Gross Margin",
      "formula": "R8 + R9",
      "description": "Revenue minus OPEX"
    },
    {
      "id": 111,
      "name": "Monthly Decay Factor",
      "formula": "(1 - L3.5/100) ^ (T.DiM/T.DiY)",
      "description": "Per-month decay multiplier based on days",
      "type": "stock"
    },
    {
      "id": 11,
      "name": "Degradation Index",
      "formula": "CUMPROD(1 - F2 + F2 * R111)",
      "description": "1 before ops, then monthly compounding decay",
      "type": "stock"
    },
    {
      "id": 12,
      "name": "OperatingAdjustment",
      "formula": "L3.1 / 100 * L3.2 / 100 * L3.3 / 100 * L3.4 / 100 * R11",
      "description": "",
      "type": "stock"
    },
    {
      "id": 13,
      "tabId": 1,
      "groupId": 4,
      "name": "EBITDA",
      "formula": "R10",
      "description": "Earnings before interest, taxes, depreciation, amortization"
    },
    {
      "id": 14,
      "tabId": 1,
      "groupId": 4,
      "name": "Depreciation",
      "formula": "-M2.3",
      "description": "From D&A module"
    },
    {
      "id": 15,
      "tabId": 1,
      "groupId": 4,
      "name": "EBIT",
      "formula": "R13 + R14",
      "description": "Earnings before interest and taxes"
    },
    {
      "id": 16,
      "tabId": 1,
      "groupId": 4,
      "name": "Interest Expense",
      "formula": "-R71",
      "description": "From Operations Debt"
    },
    {
      "id": 17,
      "tabId": 1,
      "groupId": 4,
      "name": "EBT",
      "formula": "R15 + R16",
      "description": "Earnings before taxes"
    },
    {
      "id": 18,
      "tabId": 1,
      "groupId": 4,
      "name": "Tax Expense",
      "formula": "-M5.7",
      "description": "From Tax module"
    },
    {
      "id": 19,
      "tabId": 1,
      "groupId": 4,
      "name": "NPAT",
      "formula": "R17 + R18",
      "description": "Net Profit After Tax"
    },
    {
      "id": 142,
      "tabId": 1,
      "groupId": 4,
      "name": "Prior RE",
      "formula": "(CUMSUM(R19) - R19) - (CUMSUM(R124) - R124)",
      "description": "RE before current period distribution (NPAT - distributions)",
      "type": "stock"
    },
    {
      "id": 138,
      "tabId": 1,
      "groupId": 4,
      "name": "Dividends",
      "formula": "-R124 * (R142 > 0)",
      "description": "Dividends only when prior RE positive",
      "type": "flow"
    },
    {
      "id": 143,
      "tabId": 1,
      "groupId": 4,
      "name": "Capital Returned",
      "formula": "-R124 * (R142 <= 0)",
      "description": "Return of capital when prior RE not positive",
      "type": "flow"
    },
    {
      "id": 140,
      "tabId": 1,
      "groupId": 4,
      "name": "RE - Movement",
      "formula": "R19 + R138",
      "description": "NPAT + Dividends (capital return doesn't affect RE)",
      "type": "flow"
    },
    {
      "id": 141,
      "tabId": 1,
      "groupId": 4,
      "name": "RE - Closing",
      "formula": "CUMSUM(R140)",
      "description": "Cumulative retained earnings",
      "type": "stock"
    },
    {
      "id": 139,
      "tabId": 1,
      "groupId": 4,
      "name": "RE - Opening",
      "formula": "CUMSUM(R140) - R140",
      "description": "Prior period closing = CUMSUM - current movement",
      "type": "stock"
    },
    {
      "id": 20,
      "tabId": 3,
      "groupId": 10,
      "name": "EBITDA",
      "formula": "R13",
      "description": ""
    },
    {
      "id": 21,
      "tabId": 3,
      "groupId": 10,
      "name": "WC Movement",
      "formula": "-R98",
      "description": "Negative of NWC increase (increase uses cash)"
    },
    {
      "id": 22,
      "tabId": 3,
      "groupId": 10,
      "name": "Operating CF",
      "formula": "R20 + R21",
      "description": ""
    },
    {
      "id": 23,
      "tabId": 3,
      "groupId": 11,
      "name": "Capex",
      "formula": "-V1 * F1",
      "description": ""
    },
    {
      "id": 24,
      "tabId": 3,
      "groupId": 11,
      "name": "GST Paid on Capex",
      "formula": "M3.3",
      "description": "From GST module (gst_paid outflow)"
    },
    {
      "id": 25,
      "tabId": 3,
      "groupId": 11,
      "name": "GST Receivable Release",
      "formula": "M3.5 * F2.Start",
      "description": "Construction GST receivable collected in first ops period"
    },
    {
      "id": 26,
      "tabId": 3,
      "groupId": 11,
      "name": "MRA Contribution",
      "formula": "-M7.2",
      "description": "Cash contributed to MRA (funding outflow at F1.End)"
    },
    {
      "id": 27,
      "tabId": 3,
      "groupId": 11,
      "name": "MRA Release",
      "formula": "M7.4",
      "description": "Cash released from MRA at end of maintenance period"
    },
    {
      "id": 28,
      "tabId": 3,
      "groupId": 11,
      "name": "Investing CF",
      "formula": "R23 + R24 + R25 + R26 + R27",
      "description": ""
    },
    {
      "id": 29,
      "tabId": 3,
      "groupId": 12,
      "name": "Construction Debt Drawdown",
      "formula": "M4.6",
      "description": "From Construction Funding module"
    },
    {
      "id": 31,
      "tabId": 3,
      "groupId": 12,
      "name": "Principal Repayment",
      "formula": "-R72",
      "description": "From Operations Debt"
    },
    {
      "id": 32,
      "tabId": 3,
      "groupId": 12,
      "name": "Interest Paid",
      "formula": "-R71",
      "description": "From Operations Debt"
    },
    {
      "id": 33,
      "tabId": 3,
      "groupId": 12,
      "name": "DSRA Contribution",
      "formula": "0",
      "description": ""
    },
    {
      "id": 34,
      "tabId": 3,
      "groupId": 12,
      "name": "DSRA Release",
      "formula": "0",
      "description": ""
    },
    {
      "id": 60,
      "tabId": 3,
      "groupId": 14,
      "name": "Capex + Contingency",
      "formula": "CUMSUM(R3 * F1)",
      "description": "Cumulative capex with contingency during construction",
      "type": "stock"
    },
    {
      "id": 61,
      "tabId": 3,
      "groupId": 14,
      "name": "GST Paid",
      "formula": "M3.3",
      "description": "From GST module (cumulative)",
      "type": "stock"
    },
    {
      "id": 63,
      "tabId": 3,
      "groupId": 14,
      "name": "IDC",
      "formula": "M4.5",
      "description": "From Construction Funding module",
      "type": "stock"
    },
    {
      "id": 62,
      "tabId": 3,
      "groupId": 14,
      "name": "MRA Funding",
      "formula": "C1.17 * F1.End",
      "description": "MRA funded at end of construction (3.5M)",
      "type": "flow"
    },
    {
      "id": 64,
      "tabId": 3,
      "groupId": 14,
      "name": "Total Uses",
      "formula": "M4.1 + R62",
      "description": "Construction Funding (incl IDC) + MRA Funding",
      "type": "stock"
    },
    {
      "id": 65,
      "tabId": 3,
      "groupId": 14,
      "name": "GST Received",
      "formula": "CUMSUM(M3.5 * F1)",
      "description": "GST received during construction (1-month delay)",
      "type": "stock"
    },
    {
      "id": 66,
      "tabId": 3,
      "groupId": 14,
      "name": "Construction Debt",
      "formula": "M4.2",
      "description": "From Construction Funding module",
      "type": "stock"
    },
    {
      "id": 67,
      "tabId": 3,
      "groupId": 14,
      "name": "Construction Equity",
      "formula": "M4.3",
      "description": "From Construction Funding module",
      "type": "stock"
    },
    {
      "id": 68,
      "tabId": 3,
      "groupId": 14,
      "name": "Total Sources",
      "formula": "R65 + R66 + R67 + R62",
      "description": "GST Received + Debt + Equity + MRA Funding",
      "type": "stock"
    },
    {
      "id": 69,
      "tabId": 3,
      "groupId": 14,
      "name": "Sources = Uses Check",
      "formula": "R68 - R64",
      "description": "Should be 0 (or near 0). Positive = excess sources, Negative = shortfall",
      "type": "stock"
    },
    {
      "id": 35,
      "tabId": 3,
      "groupId": 12,
      "name": "Construction Equity Injection",
      "formula": "M4.7",
      "description": "From Construction Funding module"
    },
    {
      "id": 39,
      "tabId": 3,
      "groupId": 12,
      "name": "Financing CF",
      "formula": "R29 + R31 + R32 + R33 + R34 + R35",
      "description": "Sum of all financing flows"
    },
    {
      "id": 40,
      "tabId": 3,
      "groupId": 13,
      "name": "Net Cashflow",
      "formula": "R22 + R28 + R39",
      "description": ""
    },
    {
      "id": 41,
      "tabId": 3,
      "groupId": 13,
      "name": "Opening Cash",
      "formula": "CUMSUM(R40) - R40",
      "description": "",
      "type": "stock_start"
    },
    {
      "id": 42,
      "tabId": 3,
      "groupId": 13,
      "name": "Closing Cash (Pre-Dividend)",
      "formula": "CUMSUM(R40)",
      "description": "Cash position before dividend distribution",
      "type": "stock"
    },
    {
      "id": 121,
      "tabId": 3,
      "groupId": 25,
      "name": "Cash Balance B/F",
      "formula": "R42",
      "description": "Cash available before dividend calculation",
      "type": "stock"
    },
    {
      "id": 122,
      "tabId": 3,
      "groupId": 25,
      "name": "Less: Minimum Cash Balance",
      "formula": "C1.28",
      "description": "Minimum cash reserve requirement",
      "type": "stock"
    },
    {
      "id": 123,
      "tabId": 3,
      "groupId": 25,
      "name": "Cash Available for Equity",
      "formula": "MAX(0, R121 - R122) * F2",
      "description": "Cash above minimum available for distribution (ops only)"
    },
    {
      "id": 124,
      "tabId": 3,
      "groupId": 25,
      "name": "Dividend Paid",
      "formula": "(R123 - SHIFT(R123, 1)) * F2",
      "description": "Incremental cash distributed as dividend each period (ops only)"
    },
    {
      "id": 125,
      "tabId": 3,
      "groupId": 13,
      "name": "Closing Cash (Post-Dividend)",
      "formula": "R42 - CUMSUM(R124)",
      "description": "Final cash position after dividends",
      "type": "stock"
    },
    {
      "id": 43,
      "tabId": 4,
      "groupId": 20,
      "name": "EBITDA",
      "formula": "R13",
      "description": ""
    },
    {
      "id": 44,
      "tabId": 4,
      "groupId": 20,
      "name": "Capex (incl GST)",
      "formula": "R23 + R24 - R25",
      "description": ""
    },
    {
      "id": 45,
      "tabId": 4,
      "groupId": 20,
      "name": "WC Movement",
      "formula": "R21",
      "description": ""
    },
    {
      "id": 46,
      "tabId": 4,
      "groupId": 20,
      "name": "FCFF",
      "formula": "R43 + R44 + R45",
      "description": "Free Cash Flow to Firm"
    },
    {
      "id": 47,
      "tabId": 4,
      "groupId": 20,
      "name": "Debt Service",
      "formula": "R31 + R32",
      "description": ""
    },
    {
      "id": 48,
      "tabId": 4,
      "groupId": 20,
      "name": "Debt Drawdown",
      "formula": "R29",
      "description": "Construction + Ops debt"
    },
    {
      "id": 49,
      "tabId": 4,
      "groupId": 20,
      "name": "FCFE",
      "formula": "R46 + R47 + R48",
      "description": "Free Cash Flow to Equity"
    },
    {
      "id": 50,
      "tabId": 4,
      "groupId": 21,
      "name": "Monthly Discount Rate",
      "formula": "(1 + C1.12 / 100) ^ (1/T.MiY) - 1",
      "description": "WACC converted to monthly",
      "type": "stock"
    },
    {
      "id": 51,
      "tabId": 4,
      "groupId": 21,
      "name": "Discount Factor",
      "formula": "CUMPROD(1 / (1 + R50))",
      "description": "Cumulative discount factor for NPV",
      "type": "stock"
    },
    {
      "id": 131,
      "tabId": 4,
      "groupId": 26,
      "name": "Contingent Equity",
      "formula": "0",
      "description": "Additional equity calls beyond initial (if any)"
    },
    {
      "id": 132,
      "tabId": 4,
      "groupId": 26,
      "name": "Equity Injections",
      "formula": "-R35",
      "description": "Periodic equity drawdowns during construction (outflow)"
    },
    {
      "id": 133,
      "tabId": 4,
      "groupId": 26,
      "name": "Dividends",
      "formula": "R124",
      "description": "Dividend distributions to equity (inflow)"
    },
    {
      "id": 134,
      "tabId": 4,
      "groupId": 26,
      "name": "Share Capital Repayment",
      "formula": "CUMSUM(R67) * F2.End",
      "description": "Return of equity at project end (inflow)"
    },
    {
      "id": 135,
      "tabId": 4,
      "groupId": 26,
      "name": "Investor Tax",
      "formula": "-(R133 + R134) * C1.29 / 100",
      "description": "Withholding tax on distributions (outflow)"
    },
    {
      "id": 136,
      "tabId": 4,
      "groupId": 26,
      "name": "Terminal Value",
      "formula": "R13 * T.MiY * C1.30 * F2.End",
      "description": "EBITDA multiple at project end (inflow)"
    },
    {
      "id": 137,
      "tabId": 4,
      "groupId": 26,
      "name": "Net Cash Flow to Equity",
      "formula": "R131 + R132 + R133 + R134 + R135 + R136",
      "description": "Total equity cash flows for IRR calculation"
    },
    {
      "id": 115,
      "tabId": 3,
      "groupId": 24,
      "name": "Contracted CFADS",
      "formula": "R13 * R4 / R8 * F2",
      "description": "EBITDA allocated to contracted revenue (Tolling)"
    },
    {
      "id": 116,
      "tabId": 3,
      "groupId": 24,
      "name": "Merchant CFADS",
      "formula": "R13 * R7 / R8 * F2",
      "description": "EBITDA allocated to merchant revenue (FCAS + Arb)"
    },
    {
      "id": 118,
      "tabId": 3,
      "groupId": 24,
      "name": "DSCR",
      "formula": "M1.7",
      "description": "Debt Service Coverage Ratio",
      "type": "stock"
    },
    {
      "id": 70,
      "tabId": 3,
      "groupId": 15,
      "name": "Opening Balance",
      "formula": "M1.2",
      "description": "From iterative debt sizing module",
      "type": "stock_start"
    },
    {
      "id": 71,
      "tabId": 3,
      "groupId": 15,
      "name": "Interest - Paid",
      "formula": "M1.3",
      "description": "From iterative debt sizing module"
    },
    {
      "id": 72,
      "tabId": 3,
      "groupId": 15,
      "name": "Principal",
      "formula": "M1.4",
      "description": "From iterative debt sizing module"
    },
    {
      "id": 73,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Service",
      "formula": "M1.5",
      "description": "Interest + Principal from iterative debt sizing module"
    },
    {
      "id": 74,
      "tabId": 3,
      "groupId": 15,
      "name": "Closing Balance",
      "formula": "M1.6",
      "description": "From iterative debt sizing module",
      "type": "stock"
    },
    {
      "id": 80,
      "tabId": 1,
      "groupId": 16,
      "name": "Opening Balance",
      "formula": "M2.1",
      "description": "From D&A module",
      "type": "stock_start"
    },
    {
      "id": 81,
      "tabId": 1,
      "groupId": 16,
      "name": "Addition",
      "formula": "M2.2",
      "description": "From D&A module"
    },
    {
      "id": 82,
      "tabId": 1,
      "groupId": 16,
      "name": "Depreciation",
      "formula": "M2.3",
      "description": "From D&A module"
    },
    {
      "id": 83,
      "tabId": 1,
      "groupId": 16,
      "name": "Accumulated Depreciation",
      "formula": "M2.4",
      "description": "From D&A module",
      "type": "stock"
    },
    {
      "id": 84,
      "tabId": 1,
      "groupId": 16,
      "name": "Closing Balance",
      "formula": "M2.5",
      "description": "From D&A module",
      "type": "stock"
    },
    {
      "id": 95,
      "tabId": 3,
      "groupId": 18,
      "name": "Receivables",
      "formula": "R8 * C1.13 / 30",
      "description": "Revenue * Receivable Days / Days Per Month",
      "type": "stock"
    },
    {
      "id": 96,
      "tabId": 3,
      "groupId": 18,
      "name": "Payables",
      "formula": "ABS(R9) * C1.14 / 30",
      "description": "OPEX * Payable Days / Days Per Month",
      "type": "stock"
    },
    {
      "id": 97,
      "tabId": 3,
      "groupId": 18,
      "name": "Net Working Capital",
      "formula": "R95 - R96",
      "description": "Receivables minus Payables",
      "type": "stock"
    },
    {
      "id": 98,
      "tabId": 3,
      "groupId": 18,
      "name": "WC Movement",
      "formula": "R97 - SHIFT(R97, 1)",
      "description": "Change in NWC = Closing NWC - Prior NWC"
    },
    {
      "id": 100,
      "tabId": 3,
      "groupId": 19,
      "name": "Taxable Income",
      "formula": "M5.1",
      "description": "From Tax module"
    },
    {
      "id": 101,
      "tabId": 3,
      "groupId": 19,
      "name": "Loss Pool Opening",
      "formula": "M5.2",
      "description": "From Tax module",
      "type": "stock_start"
    },
    {
      "id": 102,
      "tabId": 3,
      "groupId": 19,
      "name": "Losses Utilised",
      "formula": "M5.4",
      "description": "From Tax module"
    },
    {
      "id": 105,
      "tabId": 3,
      "groupId": 19,
      "name": "Loss Pool Closing",
      "formula": "M5.5",
      "description": "From Tax module",
      "type": "stock"
    },
    {
      "id": 103,
      "tabId": 3,
      "groupId": 19,
      "name": "Net Taxable Income",
      "formula": "M5.6",
      "description": "From Tax module"
    },
    {
      "id": 104,
      "tabId": 3,
      "groupId": 19,
      "name": "Tax Expense",
      "formula": "M5.7",
      "description": "From Tax module"
    }
  ],
  "modules": [
    {
      "id": 1769253473397,
      "templateId": "iterative_debt_sizing",
      "name": "Operation Debt",
      "description": "Binary search to find optimal debt with DSCR-sculpted repayments",
      "category": "financing",
      "inputs": {
        "contractedCfadsRef": "R115",
        "contractedDSCR": "C1.25",
        "merchantCfadsRef": "R116",
        "merchantDSCR": "C1.26",
        "debtFlagRef": "F8",
        "totalFundingRef": "R60",
        "maxGearingPct": "C1.19",
        "interestRatePct": 5,
        "tenorYears": 18,
        "debtPeriod": "Q",
        "tolerance": 0.1,
        "maxIterations": 50
      },
      "outputs": [
        "sized_debt",
        "opening_balance",
        "interest_payment",
        "principal_payment",
        "debt_service",
        "closing_balance",
        "period_dscr",
        "cumulative_principal"
      ],
      "solvedAt": 1769425160584
    },
    {
      "id": 1769317033954,
      "templateId": "depreciation_amortization",
      "name": "Depreciation & Amortization",
      "description": "CUMSUM-based ledger pattern - no circular dependencies",
      "category": "accounting",
      "inputs": {
        "additionsRef": "V1",
        "opsFlagRef": "F2",
        "lifeYears": 15,
        "method": "straight_line",
        "dbMultiplier": 2
      },
      "outputs": [
        "opening",
        "addition",
        "depreciation",
        "accumulated",
        "closing"
      ]
    },
    {
      "id": 1769320996781,
      "templateId": "gst_receivable",
      "name": "GST Paid/Received",
      "description": "GST ledger with configurable receipt delay using CUMSUM pattern",
      "category": "accounting",
      "inputs": {
        "gstBaseRef": "R112",
        "activeFlagRef": "F1",
        "gstRatePct": 10,
        "receiptDelayMonths": 1
      },
      "outputs": [
        "gst_base",
        "gst_amount",
        "gst_paid",
        "receivable_opening",
        "gst_received",
        "receivable_closing",
        "net_gst_cashflow"
      ]
    },
    {
      "id": 1769323861808,
      "templateId": "construction_funding",
      "name": "Construction Funding",
      "description": "Construction funding waterfall with IDC equity-funded",
      "category": "financing",
      "inputs": {
        "constructionCostsRef": "R60",
        "gstPaidRef": "M3.3",
        "feesRef": "",
        "sizedDebtRef": "M1.1",
        "gearingCapPct": 65,
        "interestRatePct": 5,
        "drawdownMethod": "prorata",
        "constructionFlagRef": "F1"
      },
      "outputs": [
        "total_uses_incl_idc",
        "senior_debt",
        "equity",
        "gearing_pct",
        "cumulative_idc",
        "debt_drawdown",
        "equity_drawdown",
        "idc",
        "total_uses_ex_idc"
      ],
      "solvedAt": null
    },
    {
      "id": 1769400000000,
      "templateId": "tax_losses",
      "name": "Tax & Tax Losses",
      "description": "Tax calculation with loss carry-forward using CUMSUM pattern",
      "category": "accounting",
      "inputs": {
        "taxableIncomeRef": "R17",
        "opsFlagRef": "F2",
        "taxRatePct": "30"
      },
      "outputs": [
        "taxable_income_before_losses",
        "losses_opening",
        "losses_generated",
        "losses_utilised",
        "losses_closing",
        "net_taxable_income",
        "tax_payable"
      ],
      "solvedAt": null
    },
    {
      "id": 1769408407252,
      "templateId": "construction_funding",
      "name": "Construction Funding",
      "description": "Construction funding waterfall with IDC equity-funded",
      "category": "financing",
      "inputs": {
        "constructionCostsRef": "R60",
        "gstPaidRef": "R61",
        "feesRef": "",
        "sizedDebtRef": "M1.1",
        "gearingCapPct": 65,
        "interestRatePct": 5,
        "drawdownMethod": "prorata",
        "constructionFlagRef": "F1"
      },
      "outputs": [
        "total_uses_incl_idc",
        "senior_debt",
        "equity",
        "gearing_pct",
        "cumulative_idc",
        "debt_drawdown",
        "equity_drawdown",
        "idc",
        "total_uses_ex_idc"
      ]
    },
    {
      "id": 1769500000000,
      "templateId": "reserve_account",
      "name": "MRA (Maintenance Reserve)",
      "description": "MRA funded at construction end, draws for maintenance, releases at maintenance end",
      "category": "financing",
      "inputs": {
        "accountName": "MRA",
        "fundingAmountRef": "C1.17",
        "fundingFlagRef": "F1.End",
        "drawdownRef": "S1.19",
        "drawdownFlagRef": "F12",
        "releaseFlagRef": "F12.End"
      },
      "outputs": [
        "opening",
        "funding",
        "drawdown",
        "release",
        "closing"
      ]
    },
    {
      "id": 1769425155366,
      "templateId": "depreciation_amortization",
      "name": "Depreciation & Amortization (Gold Standard)",
      "description": "CUMSUM-based ledger pattern - no circular dependencies",
      "category": "accounting",
      "inputs": {
        "additionsRef": "V1",
        "opsFlagRef": "F2",
        "lifeYears": 15,
        "method": "straight_line",
        "dbMultiplier": 2
      },
      "outputs": [
        "opening",
        "addition",
        "depreciation",
        "accumulated",
        "closing"
      ]
    }
  ],
  "moduleTemplates": [
    {
      "id": "construction_funding",
      "name": "Construction Funding (Gold Standard)",
      "description": "Construction funding waterfall with IDC equity-funded",
      "category": "financing",
      "inputs": [
        {
          "key": "constructionCostsRef",
          "label": "Construction Costs (cumulative)",
          "type": "reference",
          "default": "R60"
        },
        {
          "key": "gstPaidRef",
          "label": "GST Paid (cumulative)",
          "type": "reference",
          "default": "R61"
        },
        {
          "key": "feesRef",
          "label": "Fees/Other Uses (cumulative)",
          "type": "reference",
          "default": ""
        },
        {
          "key": "sizedDebtRef",
          "label": "Sized Debt (from Debt Module)",
          "type": "reference",
          "default": "M1.1"
        },
        {
          "key": "gearingCapPct",
          "label": "Gearing Cap (%)",
          "type": "number",
          "default": 65
        },
        {
          "key": "interestRatePct",
          "label": "IDC Interest Rate (%)",
          "type": "number",
          "default": 5
        },
        {
          "key": "drawdownMethod",
          "label": "Drawdown Method",
          "type": "select",
          "options": [
            {
              "value": "prorata",
              "label": "Pro-rata"
            },
            {
              "value": "equity_first",
              "label": "Equity First"
            }
          ],
          "default": "prorata"
        },
        {
          "key": "constructionFlagRef",
          "label": "Construction Flag",
          "type": "reference",
          "default": "F1"
        }
      ],
      "outputs": [
        "total_uses_incl_idc",
        "senior_debt",
        "equity",
        "gearing_pct",
        "cumulative_idc",
        "debt_drawdown",
        "equity_drawdown",
        "idc",
        "total_uses_ex_idc"
      ]
    },
    {
      "id": "reserve_account",
      "name": "Reserve Account (Gold Standard)",
      "description": "Reserve account (MRA/DSRA) with funding and drawdown using CUMSUM pattern",
      "category": "financing",
      "inputs": [
        {
          "key": "fundingAmountRef",
          "label": "Funding Amount",
          "type": "reference",
          "default": ""
        },
        {
          "key": "fundingFlagRef",
          "label": "Funding Flag (e.g., F1.End)",
          "type": "reference",
          "default": "F1.End"
        },
        {
          "key": "drawdownRef",
          "label": "Drawdown Amount (optional)",
          "type": "reference",
          "default": ""
        },
        {
          "key": "drawdownFlagRef",
          "label": "Drawdown Flag (e.g., F2)",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "releaseFlagRef",
          "label": "Release Flag (e.g., F2.End)",
          "type": "reference",
          "default": "F2.End"
        }
      ],
      "outputs": [
        "opening",
        "funding",
        "drawdown",
        "release",
        "closing"
      ]
    },
    {
      "id": "gst_receivable",
      "name": "GST Paid/Received (Gold Standard)",
      "description": "GST ledger with configurable receipt delay using CUMSUM pattern",
      "category": "accounting",
      "inputs": [
        {
          "key": "gstBaseRef",
          "label": "GST Base Amount (e.g., R112)",
          "type": "reference",
          "default": "R112"
        },
        {
          "key": "activeFlagRef",
          "label": "Active Period Flag",
          "type": "reference",
          "default": "F1"
        },
        {
          "key": "gstRatePct",
          "label": "GST Rate (%)",
          "type": "number",
          "default": 10
        },
        {
          "key": "receiptDelayMonths",
          "label": "Receipt Delay (months)",
          "type": "number",
          "default": 1
        }
      ],
      "outputs": [
        "gst_base",
        "gst_amount",
        "gst_paid",
        "receivable_opening",
        "gst_received",
        "receivable_closing",
        "net_gst_cashflow"
      ]
    },
    {
      "id": "tax_losses",
      "name": "Tax & Tax Losses (Gold Standard)",
      "description": "Tax calculation with loss carry-forward using CUMSUM pattern",
      "category": "accounting",
      "inputs": [
        {
          "key": "taxableIncomeRef",
          "label": "Taxable Income Before Losses",
          "type": "reference",
          "default": ""
        },
        {
          "key": "opsFlagRef",
          "label": "Operations Flag",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "taxRatePct",
          "label": "Tax Rate (%)",
          "type": "number",
          "default": 30
        }
      ],
      "outputs": [
        "taxable_income_before_losses",
        "losses_opening",
        "losses_generated",
        "losses_utilised",
        "losses_closing",
        "net_taxable_income",
        "tax_payable"
      ]
    },
    {
      "id": "depreciation_amortization",
      "name": "Depreciation & Amortization (Gold Standard)",
      "description": "CUMSUM-based ledger pattern - no circular dependencies",
      "category": "accounting",
      "inputs": [
        {
          "key": "additionsRef",
          "label": "Capital Additions Reference",
          "type": "reference",
          "default": "V1"
        },
        {
          "key": "opsFlagRef",
          "label": "Operations Flag",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "lifeYears",
          "label": "Useful Life (years)",
          "type": "number",
          "default": 15
        },
        {
          "key": "method",
          "label": "Depreciation Method",
          "type": "select",
          "options": [
            {
              "value": "straight_line",
              "label": "Straight Line"
            },
            {
              "value": "declining_balance",
              "label": "Declining Balance"
            }
          ],
          "default": "straight_line"
        },
        {
          "key": "dbMultiplier",
          "label": "DB Multiplier",
          "type": "select",
          "options": [
            {
              "value": 2,
              "label": "Double (2x)"
            },
            {
              "value": 1.5,
              "label": "150% (1.5x)"
            },
            {
              "value": 1,
              "label": "100% (1x)"
            }
          ],
          "default": 2
        }
      ],
      "outputs": [
        "opening",
        "addition",
        "depreciation",
        "accumulated",
        "closing"
      ]
    },
    {
      "id": "iterative_debt_sizing",
      "name": "Iterative Debt Sizing (DSCR Sculpted)",
      "description": "Binary search to find optimal debt with DSCR-sculpted repayments. Supports separate contracted/merchant DSCRs.",
      "category": "financing",
      "inputs": [
        {
          "key": "contractedCfadsRef",
          "label": "Contracted CFADS",
          "type": "reference",
          "default": "R115"
        },
        {
          "key": "contractedDSCR",
          "label": "Contracted DSCR",
          "type": "number_or_ref",
          "default": "C1.25"
        },
        {
          "key": "merchantCfadsRef",
          "label": "Merchant CFADS",
          "type": "reference",
          "default": "R116"
        },
        {
          "key": "merchantDSCR",
          "label": "Merchant DSCR",
          "type": "number_or_ref",
          "default": "C1.26"
        },
        {
          "key": "debtFlagRef",
          "label": "Debt Service Flag",
          "type": "reference",
          "default": "F8"
        },
        {
          "key": "totalFundingRef",
          "label": "Total Capex (ex-IDC)",
          "type": "reference",
          "default": "R60"
        },
        {
          "key": "maxGearingPct",
          "label": "Max Gearing (%)",
          "type": "number",
          "default": 65
        },
        {
          "key": "interestRatePct",
          "label": "Interest Rate (%)",
          "type": "number",
          "default": 5
        },
        {
          "key": "tenorYears",
          "label": "Debt Tenor (years)",
          "type": "number",
          "default": 18
        },
        {
          "key": "debtPeriod",
          "label": "Debt Service Period",
          "type": "select",
          "options": [
            {
              "value": "M",
              "label": "Monthly"
            },
            {
              "value": "Q",
              "label": "Quarterly"
            },
            {
              "value": "Y",
              "label": "Yearly"
            }
          ],
          "default": "Q"
        },
        {
          "key": "tolerance",
          "label": "Tolerance ($M)",
          "type": "number",
          "default": 0.1
        },
        {
          "key": "maxIterations",
          "label": "Max Iterations",
          "type": "number",
          "default": 50
        }
      ],
      "outputs": [
        "sized_debt",
        "opening_balance",
        "interest_payment",
        "principal_payment",
        "debt_service",
        "closing_balance",
        "period_dscr",
        "cumulative_principal"
      ]
    }
  ]
}