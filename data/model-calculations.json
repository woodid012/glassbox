{
  "_description": "Model structure - formulas and relationships only",
  "calculationsTabs": [
    {
      "id": 1,
      "name": "IFS"
    },
    {
      "id": 2,
      "name": "Funding"
    },
    {
      "id": 3,
      "name": "Ops"
    },
    {
      "id": 4,
      "name": "Valuation"
    },
    {
      "id": 5,
      "name": "B/S"
    },
    {
      "id": 6,
      "name": "Cashflow"
    }
  ],
  "calculationsGroups": [
    {
      "id": 4,
      "tabId": 1,
      "name": "Profitability",
      "startYear": 2028,
      "startMonth": 10,
      "endYear": 2053,
      "endMonth": 9
    },
    {
      "id": 16,
      "tabId": 1,
      "name": "D&A"
    },
    {
      "id": 19,
      "tabId": 1,
      "name": "Tax"
    },
    {
      "id": 30,
      "tabId": 6,
      "name": "Operating CF"
    },
    {
      "id": 31,
      "tabId": 6,
      "name": "Investing CF"
    },
    {
      "id": 32,
      "tabId": 6,
      "name": "Financing CF"
    },
    {
      "id": 13,
      "tabId": 6,
      "name": "Cash Position"
    },
    {
      "id": 18,
      "tabId": 1,
      "name": "Working Capital"
    },
    {
      "id": 36,
      "tabId": 2,
      "name": "S&U: Uses"
    },
    {
      "id": 37,
      "tabId": 2,
      "name": "S&U: Sources"
    },
    {
      "id": 38,
      "tabId": 2,
      "name": "S&U: Check"
    },
    {
      "id": 15,
      "tabId": 2,
      "name": "Operations Debt"
    },
    {
      "id": 24,
      "tabId": 2,
      "name": "Covenants"
    },
    {
      "id": 26,
      "tabId": 2,
      "name": "Equity IRR"
    },
    {
      "id": 25,
      "tabId": 2,
      "name": "Dividends"
    },
    {
      "id": 34,
      "tabId": 2,
      "name": "SC Repayment"
    },
    {
      "id": 35,
      "tabId": 2,
      "name": "Profit Tests"
    },
    {
      "id": 27,
      "tabId": 3,
      "name": "Technical"
    },
    {
      "id": 28,
      "tabId": 3,
      "name": "Revenue"
    },
    {
      "id": 29,
      "tabId": 3,
      "name": "Opex"
    },
    {
      "id": 33,
      "tabId": 3,
      "name": "Maintenance"
    },
    {
      "id": 20,
      "tabId": 4,
      "name": "Free Cash Flow"
    },
    {
      "id": 21,
      "tabId": 4,
      "name": "Discount Factors"
    },
    {
      "id": 39,
      "tabId": 5,
      "name": "Assets"
    },
    {
      "id": 40,
      "tabId": 5,
      "name": "Liabilities"
    },
    {
      "id": 41,
      "tabId": 5,
      "name": "Equity"
    },
    {
      "id": 42,
      "tabId": 5,
      "name": "B/S Check"
    },
    {
      "id": 23,
      "tabId": "all",
      "name": "Calculations"
    }
  ],
  "calculations": [
    {
      "id": 119,
      "groupId": 27,
      "name": "Model Period",
      "formula": "CUMSUM(1)",
      "description": "Period counter (1, 2, 3, ...)",
      "type": "stock"
    },
    {
      "id": 120,
      "groupId": 27,
      "name": "Ops Period",
      "formula": "CUMSUM(F2)",
      "description": "Operations period counter (0 until ops, then 1, 2, 3, ...)",
      "type": "stock"
    },
    {
      "id": 3,
      "groupId": 27,
      "name": "Capex + Cont",
      "formula": "V1 * (1 + C1.23 / 100)",
      "description": "CAPEX with contingency applied"
    },
    {
      "id": 112,
      "groupId": 27,
      "name": "Capex to Apply GST",
      "formula": "V1 - V1.1 - V1.9",
      "description": "CAPEX minus EPC-BESS (import) minus Land Transaction (stamp duty) - both GST-free"
    },
    {
      "id": 4,
      "groupId": 28,
      "name": "Tolling Revenue",
      "formula": "C1.10 * C1.1 * T.HiY / T.MiY / 10^6 * F6 * I2",
      "description": "Contracted tolling revenue"
    },
    {
      "id": 5,
      "groupId": 28,
      "name": "FCAS Revenue",
      "formula": "L1.2 * C1.1 / T.MiY / 10^6 * F7 * I2",
      "description": "Frequency control ancillary services"
    },
    {
      "id": 6,
      "groupId": 28,
      "name": "Market Arbitrage Revenue",
      "formula": "L1.1 * C1.1 / 10^6 / T.MiY * F7 * R12 * I2",
      "description": "Arbitrage revenue (L1.1 annual, /12 for monthly)"
    },
    {
      "id": 179,
      "groupId": 28,
      "name": "Minor Event Revenue",
      "formula": "C1.1 * C1.43 / C1.44 / T.MiY / 10^6 * F7 * R12 * I2",
      "description": "Minor augmentation event revenue (capacity * $/MW / frequency / 12, technical adj, CPI-indexed)"
    },
    {
      "id": 180,
      "groupId": 28,
      "name": "Major Event Revenue",
      "formula": "C1.1 * C1.45 / C1.46 / T.MiY / 10^6 * F7 * R12 * I2",
      "description": "Major augmentation event revenue (capacity * $/MW / frequency / 12, technical adj, CPI-indexed)"
    },
    {
      "id": 181,
      "groupId": 28,
      "name": "Market Event Revenue",
      "formula": "R179 + R180",
      "description": "Minor + Major event revenue"
    },
    {
      "id": 7,
      "groupId": 28,
      "name": "Merchant Revenue",
      "formula": "(R5 + R6 + R181) * (1 - F4 + F4 * C1.56 / 100)",
      "description": "FCAS + Arbitrage + Market Events (95% during Life Extension)"
    },
    {
      "id": 8,
      "tabId": 1,
      "groupId": 4,
      "name": "Total Revenue",
      "formula": "R4 + R7",
      "description": "Tolling + Merchant"
    },
    {
      "id": 9,
      "tabId": 1,
      "groupId": 4,
      "name": "Total OPEX (Nominal)",
      "formula": "-S1 * I2",
      "description": "OPEX group sum"
    },
    {
      "id": 10,
      "tabId": 1,
      "groupId": 4,
      "name": "Gross Margin",
      "formula": "R8 + R9",
      "description": "Revenue minus OPEX"
    },
    {
      "id": 111,
      "groupId": 27,
      "name": "Monthly Decay Factor",
      "formula": "(1 - L3.5/100) ^ (T.DiM/T.DiY)",
      "description": "Per-month decay multiplier based on days",
      "type": "stock"
    },
    {
      "id": 11,
      "groupId": 27,
      "name": "Degradation Index",
      "formula": "CUMPROD(1 - F2 + F2 * R111)",
      "description": "1 before ops, then monthly compounding decay",
      "type": "stock"
    },
    {
      "id": 12,
      "groupId": 27,
      "name": "Operating Adjustment",
      "formula": "L3.1 / 100 * L3.2 / 100 * L3.3 / 100 * L3.4 / 100 * R11",
      "description": "Combined technical adjustment factor",
      "type": "stock"
    },
    {
      "id": 13,
      "tabId": 1,
      "groupId": 4,
      "name": "EBITDA",
      "formula": "R10",
      "description": "Earnings before interest, taxes, depreciation, amortization"
    },
    {
      "id": 14,
      "tabId": 1,
      "groupId": 4,
      "name": "P&L Depreciation",
      "formula": "-M2.3",
      "description": "From D&A module"
    },
    {
      "id": 15,
      "tabId": 1,
      "groupId": 4,
      "name": "EBIT",
      "formula": "R13 + R14",
      "description": "Earnings before interest and taxes"
    },
    {
      "id": 16,
      "tabId": 1,
      "groupId": 4,
      "name": "Interest Expense",
      "formula": "-R71",
      "description": "From Operations Debt"
    },
    {
      "id": 17,
      "tabId": 1,
      "groupId": 4,
      "name": "EBT",
      "formula": "R15 + R16 + R174 - R144 - R146 + R153",
      "description": "Earnings before taxes (incl. agency fee, upfront fees, commitment fees, DSRF fees)"
    },
    {
      "id": 18,
      "tabId": 1,
      "groupId": 4,
      "name": "Tax Expense",
      "formula": "-M5.7",
      "description": "From Tax module"
    },
    {
      "id": 19,
      "tabId": 1,
      "groupId": 4,
      "name": "NPAT",
      "formula": "R17 + R18",
      "description": "Net Profit After Tax"
    },
    {
      "id": 142,
      "tabId": 1,
      "groupId": 4,
      "name": "Prior RE",
      "formula": "M7.2",
      "description": "RE before current period (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 138,
      "tabId": 1,
      "groupId": 4,
      "name": "P&L Dividends Declared",
      "formula": "-M7.6",
      "description": "Dividends (from Distributions module)",
      "type": "flow"
    },
    {
      "id": 143,
      "tabId": 1,
      "groupId": 4,
      "name": "Share Capital Returned",
      "formula": "-M7.11",
      "description": "Share capital repayment (from Distributions module)",
      "type": "flow"
    },
    {
      "id": 140,
      "tabId": 1,
      "groupId": 4,
      "name": "RE - Movement",
      "formula": "M7.7",
      "description": "RE movement (from Distributions module)",
      "type": "flow"
    },
    {
      "id": 141,
      "tabId": 1,
      "groupId": 4,
      "name": "RE - Closing",
      "formula": "M7.8",
      "description": "Retained earnings closing (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 20,
      "tabId": 3,
      "groupId": 30,
      "name": "Operating CF EBITDA",
      "formula": "R13",
      "description": ""
    },
    {
      "id": 21,
      "tabId": 3,
      "groupId": 30,
      "name": "Operating CF WC Movement",
      "formula": "-R98",
      "description": "Negative of NWC increase (increase uses cash)"
    },
    {
      "id": 174,
      "tabId": 3,
      "groupId": 32,
      "name": "Agency Fee",
      "formula": "-S3 * I2",
      "description": "Facility agent fee (indexed by CPI)"
    },
    {
      "id": 22,
      "tabId": 3,
      "groupId": 30,
      "name": "Operating CF",
      "formula": "R20 + R21",
      "description": "EBITDA + WC Movement"
    },
    {
      "id": 23,
      "tabId": 3,
      "groupId": 31,
      "name": "Capex",
      "formula": "-V1 * F1",
      "description": ""
    },
    {
      "id": 24,
      "tabId": 3,
      "groupId": 31,
      "name": "GST Paid on Capex",
      "formula": "M3.3",
      "description": "From GST module (gst_paid outflow)"
    },
    {
      "id": 25,
      "tabId": 3,
      "groupId": 31,
      "name": "GST Received (Operations)",
      "formula": "M3.9",
      "description": "GST receipts during operations (from module construction/operations split)"
    },
    {
      "id": 26,
      "tabId": 3,
      "groupId": 31,
      "name": "MRA Contribution",
      "formula": "-M6.2",
      "description": "Cash contributed to MRA (funding outflow at F1.End)"
    },
    {
      "id": 27,
      "tabId": 3,
      "groupId": 31,
      "name": "MRA Release",
      "formula": "M6.4",
      "description": "Cash released from MRA at end of maintenance period"
    },
    {
      "id": 149,
      "tabId": 3,
      "groupId": 31,
      "name": "MRA Drawdown (Maintenance)",
      "formula": "M6.3",
      "description": "Cash inflow from MRA to pay maintenance (offsets OPEX in Operating CF)"
    },
    {
      "id": 202,
      "tabId": 3,
      "groupId": 31,
      "name": "GST Received (Construction)",
      "formula": "M3.8",
      "description": "GST refund received during construction"
    },
    {
      "id": 28,
      "tabId": 3,
      "groupId": 31,
      "name": "Investing CF",
      "formula": "R23 + R24 + R25 + R26 + R27 + R149 + R202",
      "description": "Investing CF subtotal"
    },
    {
      "id": 29,
      "tabId": 3,
      "groupId": 32,
      "name": "Construction Debt Drawdown",
      "formula": "M4.6",
      "description": "From Construction Funding module"
    },
    {
      "id": 31,
      "tabId": 3,
      "groupId": 32,
      "name": "Principal Repayment",
      "formula": "-R72",
      "description": "From Operations Debt"
    },
    {
      "id": 32,
      "tabId": 3,
      "groupId": 32,
      "name": "Interest Paid",
      "formula": "-R71",
      "description": "From Operations Debt"
    },
    {
      "id": 178,
      "tabId": 3,
      "groupId": 32,
      "name": "Total Debt Service",
      "formula": "R31 + R32 + R174 + R153",
      "description": "Principal + Interest + Agency Fee + DSRF Fees"
    },
    {
      "id": 33,
      "tabId": 3,
      "groupId": 32,
      "name": "DSRA Contribution",
      "formula": "0",
      "description": ""
    },
    {
      "id": 34,
      "tabId": 3,
      "groupId": 32,
      "name": "DSRA Release",
      "formula": "0",
      "description": ""
    },
    {
      "id": 151,
      "tabId": 3,
      "groupId": 32,
      "name": "Interest Income",
      "formula": "0",
      "description": "Placeholder - interest earned on cash balances"
    },
    {
      "id": 152,
      "tabId": 3,
      "groupId": 32,
      "name": "DSRA Shortfall Contribution",
      "formula": "0",
      "description": "Placeholder - additional funding to DSRA when balance below target"
    },
    {
      "id": 153,
      "tabId": 3,
      "groupId": 32,
      "name": "DSRF Fees",
      "formula": "-M8.6",
      "description": "Total DSRF fees (establishment + commitment + refinancing) from DSRF module"
    },
    {
      "id": 199,
      "tabId": 3,
      "groupId": 32,
      "name": "Upfront Fees Paid",
      "formula": "-R144",
      "description": "Cash outflow for upfront financing fees"
    },
    {
      "id": 200,
      "tabId": 3,
      "groupId": 32,
      "name": "Commitment Fees Paid",
      "formula": "-R146",
      "description": "Cash outflow for commitment fees"
    },
    {
      "id": 201,
      "tabId": 3,
      "groupId": 32,
      "name": "IDC Paid",
      "formula": "-M4.8",
      "description": "Cash outflow for interest during construction"
    },
    {
      "id": 154,
      "tabId": 3,
      "groupId": 32,
      "name": "Share Capital Repayment",
      "formula": "-M7.11",
      "description": "Return of equity capital (from Distributions module)"
    },
    {
      "id": 155,
      "tabId": 3,
      "groupId": 32,
      "name": "Dividends Paid",
      "formula": "-M7.6",
      "description": "Dividend distributions to equity (from Distributions module)"
    },
    {
      "id": 60,
      "tabId": 3,
      "groupId": 36,
      "name": "Capex + Contingency",
      "formula": "CUMSUM(R3 * F1)",
      "description": "Cumulative capex with contingency during construction",
      "type": "stock"
    },
    {
      "id": 63,
      "tabId": 3,
      "groupId": 36,
      "name": "IDC",
      "formula": "M4.5",
      "description": "From Construction Funding module",
      "type": "stock"
    },
    {
      "id": 144,
      "tabId": 3,
      "groupId": 36,
      "name": "Upfront Fees",
      "formula": "(M1.1 * C1.34 / 100 + C1.35) * F1.Start",
      "description": "Establishment fee (1.35% of limit) + upfront fees ($2M) at financial close",
      "type": "flow"
    },
    {
      "id": 146,
      "tabId": 3,
      "groupId": 36,
      "name": "Commitment Fees",
      "formula": "M1.1 * C1.33 / 100 * C1.36 / 100 / T.MiY * F1",
      "description": "Commitment fee on undrawn ops facility during construction (40% of 1.75% margin)",
      "type": "flow"
    },
    {
      "id": 173,
      "tabId": 3,
      "groupId": 36,
      "name": "Financing Fees",
      "formula": "CUMSUM(R144 + R146)",
      "description": "Cumulative upfront fees + commitment fees",
      "type": "stock"
    },
    {
      "id": 147,
      "tabId": 3,
      "groupId": 36,
      "name": "Agency Fees",
      "formula": "CUMSUM(S3 * I2 * F1)",
      "description": "Cumulative facility agent fee during construction (CPI-indexed, for S&U)",
      "type": "stock"
    },
    {
      "id": 62,
      "tabId": 3,
      "groupId": 36,
      "name": "MRA Funding",
      "formula": "CUMSUM(M6.2)",
      "description": "MRA funded at end of construction (from MRA module)",
      "type": "stock"
    },
    {
      "id": 61,
      "tabId": 3,
      "groupId": 36,
      "name": "GST Paid",
      "formula": "CUMSUM(R24)",
      "description": "Cumulative of R24 (GST Paid on Capex)",
      "type": "stock"
    },
    {
      "id": 145,
      "tabId": 3,
      "groupId": 36,
      "name": "DSRF Facility Limit",
      "formula": "M8.1",
      "description": "DSRF facility limit (notional, from DSRF module)",
      "type": "flow"
    },
    {
      "id": 148,
      "tabId": 3,
      "groupId": 36,
      "name": "Construction Cash Reserving",
      "formula": "0",
      "description": "Placeholder",
      "type": "flow"
    },
    {
      "id": 64,
      "tabId": 3,
      "groupId": 36,
      "name": "Total Uses",
      "formula": "R60 + R63 + R173 + R147 + R62 + R61",
      "description": "Capex + IDC + Financing Fees + Agency Fees + MRA + GST Paid",
      "type": "stock"
    },
    {
      "id": 65,
      "tabId": 3,
      "groupId": 37,
      "name": "GST Received",
      "formula": "CUMSUM(M3.8)",
      "description": "GST received during construction (1-month delay, from module split)",
      "type": "stock"
    },
    {
      "id": 66,
      "tabId": 3,
      "groupId": 37,
      "name": "Senior Debt",
      "formula": "M4.2",
      "description": "From Construction Funding module",
      "type": "stock"
    },
    {
      "id": 67,
      "tabId": 3,
      "groupId": 37,
      "name": "Committed Equity",
      "formula": "R64 - R65 - R66",
      "description": "Equity is the residual: Total Uses - GST Received - Senior Debt",
      "type": "stock"
    },
    {
      "id": 68,
      "tabId": 3,
      "groupId": 37,
      "name": "Total Sources",
      "formula": "R65 + R66 + R67",
      "description": "GST Received + Senior Debt + Committed Equity",
      "type": "stock"
    },
    {
      "id": 69,
      "tabId": 3,
      "groupId": 38,
      "name": "Sources = Uses Check",
      "formula": "R68 - R64",
      "description": "Should be 0. Positive = excess sources, Negative = shortfall",
      "type": "stock"
    },
    {
      "id": 35,
      "tabId": 3,
      "groupId": 32,
      "name": "Construction Equity Injection",
      "formula": "M4.7",
      "description": "From Construction Funding module"
    },
    {
      "id": 169,
      "tabId": 3,
      "groupId": 32,
      "name": "Financing CF (ex-Dist)",
      "formula": "R29 + R31 + R32 + R174 + R33 + R34 + R35 + R151 + R152 + R153 + R199 + R200 + R201",
      "description": "Financing flows excluding shareholder distributions"
    },
    {
      "id": 39,
      "tabId": 3,
      "groupId": 32,
      "name": "Financing CF",
      "formula": "R169 + R154 + R155",
      "description": "Sum of all financing flows (including distributions)"
    },
    {
      "id": 170,
      "tabId": 3,
      "groupId": 13,
      "name": "Net CF (ex-Dist)",
      "formula": "R22 + R28 + R169",
      "description": "Net cashflow before shareholder distributions"
    },
    {
      "id": 40,
      "tabId": 3,
      "groupId": 13,
      "name": "Net Cashflow",
      "formula": "R170 + R154 + R155",
      "description": "Net cashflow including distributions"
    },
    {
      "id": 41,
      "tabId": 3,
      "groupId": 13,
      "name": "Cash Opening Balance",
      "formula": "CUMSUM(R40) - R40",
      "description": "",
      "type": "stock_start"
    },
    {
      "id": 42,
      "tabId": 3,
      "groupId": 13,
      "name": "Cash Closing Balance",
      "formula": "CUMSUM(R40)",
      "description": "Final cash balance (includes all distributions)",
      "type": "stock"
    },
    {
      "id": 159,
      "groupId": 34,
      "name": "SC - Cash Available",
      "formula": "M7.10",
      "description": "Cash available for SC repayment (from Distributions module)"
    },
    {
      "id": 160,
      "groupId": 34,
      "name": "SC - Repayment",
      "formula": "M7.11",
      "description": "Share capital repayment (from Distributions module)"
    },
    {
      "id": 161,
      "groupId": 34,
      "name": "SC - Cumulative Returned",
      "formula": "CUMSUM(M7.11)",
      "description": "Running total capital returned (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 123,
      "groupId": 25,
      "name": "Cash Available",
      "formula": "M7.1",
      "description": "Cash available for distributions (from M7)"
    },
    {
      "id": 164,
      "groupId": 35,
      "name": "RE - Opening Balance",
      "formula": "M7.2",
      "description": "Retained earnings opening (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 165,
      "groupId": 35,
      "name": "RE - NPAT",
      "formula": "M7.3",
      "description": "NPAT (from Distributions module)"
    },
    {
      "id": 166,
      "groupId": 35,
      "name": "RE - Test Result",
      "formula": "M7.4",
      "description": "RE test result (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 168,
      "groupId": 35,
      "name": "NPAT - Test Result",
      "formula": "M7.5",
      "description": "NPAT test result (from Distributions module)",
      "type": "stock"
    },
    {
      "id": 43,
      "tabId": 4,
      "groupId": 20,
      "name": "FCF EBITDA",
      "formula": "R13",
      "description": ""
    },
    {
      "id": 44,
      "tabId": 4,
      "groupId": 20,
      "name": "Capex (incl GST)",
      "formula": "R23 + R24 - R25",
      "description": ""
    },
    {
      "id": 45,
      "tabId": 4,
      "groupId": 20,
      "name": "FCF WC Movement",
      "formula": "R21",
      "description": ""
    },
    {
      "id": 46,
      "tabId": 4,
      "groupId": 20,
      "name": "FCFF",
      "formula": "R43 + R44 + R45",
      "description": "Free Cash Flow to Firm"
    },
    {
      "id": 47,
      "tabId": 4,
      "groupId": 20,
      "name": "FCF Debt Service",
      "formula": "R31 + R32",
      "description": ""
    },
    {
      "id": 48,
      "tabId": 4,
      "groupId": 20,
      "name": "FCF Debt Drawdown",
      "formula": "R29",
      "description": "Construction + Ops debt"
    },
    {
      "id": 49,
      "tabId": 4,
      "groupId": 20,
      "name": "FCFE",
      "formula": "R46 + R47 + R48",
      "description": "Free Cash Flow to Equity"
    },
    {
      "id": 50,
      "tabId": 4,
      "groupId": 21,
      "name": "Monthly Discount Rate",
      "formula": "(1 + C1.12 / 100) ^ (1/T.MiY) - 1",
      "description": "WACC converted to monthly",
      "type": "stock"
    },
    {
      "id": 51,
      "tabId": 4,
      "groupId": 21,
      "name": "Discount Factor",
      "formula": "CUMPROD(1 / (1 + R50))",
      "description": "Cumulative discount factor for NPV",
      "type": "stock"
    },
    {
      "id": 131,
      "tabId": 4,
      "groupId": 26,
      "name": "Contingent Equity",
      "formula": "0",
      "description": "Additional equity calls beyond initial (if any)"
    },
    {
      "id": 132,
      "tabId": 4,
      "groupId": 26,
      "name": "Equity Injections",
      "formula": "-R35",
      "description": "Periodic equity drawdowns during construction (outflow)"
    },
    {
      "id": 133,
      "tabId": 4,
      "groupId": 26,
      "name": "Dividends",
      "formula": "M7.6",
      "description": "Dividend distributions to equity (from Distributions module)"
    },
    {
      "id": 134,
      "tabId": 4,
      "groupId": 26,
      "name": "Share Capital Repayment",
      "formula": "M7.11",
      "description": "Return of equity capital (from Distributions module)"
    },
    {
      "id": 135,
      "tabId": 4,
      "groupId": 26,
      "name": "Investor Tax",
      "formula": "-(R133 + R134) * C1.29 / 100",
      "description": "Withholding tax on distributions (outflow)"
    },
    {
      "id": 136,
      "tabId": 4,
      "groupId": 26,
      "name": "Terminal Value",
      "formula": "C1.30 * I2 * F5",
      "description": "Fixed terminal value ($17.5M) indexed by CPI at TV period"
    },
    {
      "id": 137,
      "tabId": 4,
      "groupId": 26,
      "name": "Net Cash Flow to Equity",
      "formula": "R131 + R132 + R133 + R134 + R135 + R136",
      "description": "Total equity cash flows for IRR calculation"
    },
    {
      "id": 115,
      "tabId": 3,
      "groupId": 24,
      "name": "Contracted CFADS",
      "formula": "R13 * R4 / R8 * F2",
      "description": "EBITDA allocated to contracted revenue (Tolling)"
    },
    {
      "id": 116,
      "tabId": 3,
      "groupId": 24,
      "name": "Merchant CFADS",
      "formula": "R13 * R7 / R8 * F2",
      "description": "EBITDA allocated to merchant revenue (FCAS + Arb)"
    },
    {
      "id": 118,
      "tabId": 3,
      "groupId": 24,
      "name": "DSCR",
      "formula": "M1.7",
      "description": "Debt Service Coverage Ratio",
      "type": "stock"
    },
    {
      "id": 205,
      "tabId": 3,
      "groupId": 24,
      "name": "Total CFADS",
      "formula": "R115 + R116",
      "description": "Combined contracted + merchant CFADS for ADSCR calculation"
    },
    {
      "id": 70,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Opening Balance",
      "formula": "M1.2",
      "description": "From iterative debt sizing module",
      "type": "stock_start"
    },
    {
      "id": 71,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Interest Paid",
      "formula": "M1.3",
      "description": "From iterative debt sizing module"
    },
    {
      "id": 72,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Principal Repayment",
      "formula": "M1.4",
      "description": "From iterative debt sizing module"
    },
    {
      "id": 73,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Service (P+I)",
      "formula": "M1.5",
      "description": "Interest + Principal from iterative debt sizing module"
    },
    {
      "id": 74,
      "tabId": 3,
      "groupId": 15,
      "name": "Debt Closing Balance",
      "formula": "M1.6",
      "description": "From iterative debt sizing module",
      "type": "stock"
    },
    {
      "id": 203,
      "tabId": 1,
      "groupId": 16,
      "name": "Total Capital Additions",
      "formula": "V1 + M4.8",
      "description": "Per-period capex + IDC (combined additions for D&A depreciable base)"
    },
    {
      "id": 80,
      "tabId": 1,
      "groupId": 16,
      "name": "D&A Opening Book Value",
      "formula": "M2.1",
      "description": "From D&A module",
      "type": "stock_start"
    },
    {
      "id": 81,
      "tabId": 1,
      "groupId": 16,
      "name": "D&A Asset Addition",
      "formula": "M2.2",
      "description": "From D&A module"
    },
    {
      "id": 82,
      "tabId": 1,
      "groupId": 16,
      "name": "D&A Depreciation Expense",
      "formula": "M2.3",
      "description": "From D&A module"
    },
    {
      "id": 83,
      "tabId": 1,
      "groupId": 16,
      "name": "D&A Accumulated Depreciation",
      "formula": "M2.4",
      "description": "From D&A module",
      "type": "stock"
    },
    {
      "id": 84,
      "tabId": 1,
      "groupId": 16,
      "name": "D&A Closing Book Value",
      "formula": "M2.5",
      "description": "From D&A module",
      "type": "stock"
    },
    {
      "id": 175,
      "tabId": 3,
      "groupId": 18,
      "name": "Tolling Quarterly Accrual",
      "formula": "R4 + SHIFT(R4,1)*(1-SHIFT(T.QE,1)) + SHIFT(R4,2)*(1-SHIFT(T.QE,2))*(1-SHIFT(T.QE,1))",
      "description": "Rolling quarterly sum of tolling revenue (resets after each QE)",
      "type": "stock"
    },
    {
      "id": 176,
      "tabId": 3,
      "groupId": 18,
      "name": "Tolling Receivable",
      "formula": "R175 * (1 - T.QE)",
      "description": "Tolling AR - accrues monthly, collected at quarter end",
      "type": "stock"
    },
    {
      "id": 177,
      "tabId": 3,
      "groupId": 18,
      "name": "Merchant Receivable",
      "formula": "R7 * C1.13 / 30",
      "description": "Merchant revenue receivable (days-based)",
      "type": "stock"
    },
    {
      "id": 95,
      "tabId": 3,
      "groupId": 18,
      "name": "Receivables",
      "formula": "R176 + R177",
      "description": "Tolling (quarterly) + Merchant (days-based)",
      "type": "stock"
    },
    {
      "id": 96,
      "tabId": 3,
      "groupId": 18,
      "name": "Payables",
      "formula": "ABS(R9) * C1.14 / 30",
      "description": "OPEX * Payable Days / Days Per Month",
      "type": "stock"
    },
    {
      "id": 97,
      "tabId": 3,
      "groupId": 18,
      "name": "Net Working Capital",
      "formula": "R95 - R96",
      "description": "Receivables minus Payables",
      "type": "stock"
    },
    {
      "id": 98,
      "tabId": 3,
      "groupId": 18,
      "name": "Net WC Movement",
      "formula": "R97 - SHIFT(R97, 1)",
      "description": "Change in NWC = Closing NWC - Prior NWC"
    },
    {
      "id": 100,
      "tabId": 3,
      "groupId": 19,
      "name": "Tax Taxable Income",
      "formula": "M5.1",
      "description": "From Tax module"
    },
    {
      "id": 101,
      "tabId": 3,
      "groupId": 19,
      "name": "Loss Pool Opening",
      "formula": "M5.2",
      "description": "From Tax module",
      "type": "stock_start"
    },
    {
      "id": 102,
      "tabId": 3,
      "groupId": 19,
      "name": "Losses Utilised",
      "formula": "M5.4",
      "description": "From Tax module"
    },
    {
      "id": 105,
      "tabId": 3,
      "groupId": 19,
      "name": "Loss Pool Closing",
      "formula": "M5.5",
      "description": "From Tax module",
      "type": "stock"
    },
    {
      "id": 103,
      "tabId": 3,
      "groupId": 19,
      "name": "Tax Net Taxable Income",
      "formula": "M5.6",
      "description": "From Tax module"
    },
    {
      "id": 104,
      "tabId": 3,
      "groupId": 19,
      "name": "Tax Payable",
      "formula": "M5.7",
      "description": "From Tax module"
    },
    {
      "id": 171,
      "groupId": 27,
      "name": "All-in Interest Rate - Construction (%)",
      "formula": "L2.2 + C1.32",
      "description": "Base Rate (L2.2) + Construction Margin (C1.32 = 1.8%)",
      "type": "stock"
    },
    {
      "id": 172,
      "groupId": 27,
      "name": "All-in Interest Rate - Operations (%)",
      "formula": "L2.2 + C1.33",
      "description": "Base Rate (L2.2) + Operations Margin (C1.33 = 1.75%)",
      "type": "stock"
    },
    {
      "id": 182,
      "groupId": 39,
      "name": "Cash & Cash Equivalents",
      "formula": "R42",
      "description": "Closing cash position",
      "type": "stock"
    },
    {
      "id": 196,
      "groupId": 39,
      "name": "Construction WIP",
      "formula": "(CUMSUM(V1 * F1) + R63) * F1",
      "description": "Capex + capitalised IDC during construction (zero after COD â€” asset transfers to PP&E via D&A module)",
      "type": "stock"
    },
    {
      "id": 183,
      "groupId": 39,
      "name": "PP&E (Net Book Value)",
      "formula": "R84",
      "description": "D&A closing balance (net of accumulated depreciation, post-COD)",
      "type": "stock"
    },
    {
      "id": 184,
      "groupId": 39,
      "name": "Trade Receivables",
      "formula": "R95",
      "description": "Tolling + Merchant receivables",
      "type": "stock"
    },
    {
      "id": 185,
      "groupId": 39,
      "name": "GST Receivable",
      "formula": "M3.6",
      "description": "GST receivable closing balance from GST module",
      "type": "stock"
    },
    {
      "id": 186,
      "groupId": 39,
      "name": "MRA Balance",
      "formula": "M6.5",
      "description": "Maintenance reserve account closing balance",
      "type": "stock"
    },
    {
      "id": 187,
      "groupId": 39,
      "name": "Total Assets",
      "formula": "R182 + R196 + R183 + R184 + R185 + R186",
      "description": "Cash + WIP + PP&E + Receivables + GST + MRA",
      "type": "stock"
    },
    {
      "id": 198,
      "groupId": 40,
      "name": "Construction Debt",
      "formula": "M4.2 * F1",
      "description": "Cumulative senior debt drawn during construction (M4.2), zero after COD",
      "type": "stock"
    },
    {
      "id": 188,
      "groupId": 40,
      "name": "Operations Debt",
      "formula": "R74",
      "description": "Operations debt closing balance (M1.6), active from COD",
      "type": "stock"
    },
    {
      "id": 189,
      "groupId": 40,
      "name": "Trade Payables",
      "formula": "R96",
      "description": "OPEX-based payables (30-day terms)",
      "type": "stock"
    },
    {
      "id": 190,
      "groupId": 40,
      "name": "Total Liabilities",
      "formula": "R198 + R188 + R189",
      "description": "Construction Debt + Operations Debt + Payables",
      "type": "stock"
    },
    {
      "id": 191,
      "groupId": 41,
      "name": "Share Capital",
      "formula": "CUMSUM(M4.7) * F1 + M7.12 * F2",
      "description": "Construction: cumulative equity drawn (M4.7) gated by F1. Operations: SC closing from distributions module (M7.12) gated by F2. Both gates required - M7.12 outputs totalEquityContributed during construction, so F2 prevents double-counting.",
      "type": "stock"
    },
    {
      "id": 192,
      "groupId": 41,
      "name": "Retained Earnings",
      "formula": "R141",
      "description": "Retained earnings closing balance",
      "type": "stock"
    },
    {
      "id": 193,
      "groupId": 41,
      "name": "Total Equity",
      "formula": "R191 + R192",
      "description": "Share capital + retained earnings",
      "type": "stock"
    },
    {
      "id": 194,
      "groupId": 42,
      "name": "Total L + E",
      "formula": "R190 + R193",
      "description": "Total liabilities plus total equity",
      "type": "stock"
    },
    {
      "id": 195,
      "groupId": 42,
      "name": "Balance Check",
      "formula": "R187 - R194",
      "description": "Should be zero if B/S balances (Total Assets - Total L&E)",
      "type": "stock"
    }
  ],
  "modules": [
    {
      "id": 1769253473397,
      "templateId": "iterative_debt_sizing",
      "name": "Operation Debt",
      "description": "Binary search to find optimal debt with DSCR-sculpted repayments",
      "category": "financing",
      "inputs": {
        "contractedCfadsRef": "R115",
        "contractedDSCR": "C1.25",
        "merchantCfadsRef": "R116",
        "merchantDSCR": "C1.26",
        "debtFlagRef": "F8",
        "totalFundingRef": "R60",
        "maxGearingPct": "C1.19",
        "interestRatePct": "R172",
        "tenorYears": "C1.27",
        "debtPeriod": "Q",
        "tolerance": 0.1,
        "maxIterations": 50
      },
      "outputs": [
        "sized_debt",
        "opening_balance",
        "interest_payment",
        "principal_payment",
        "debt_service",
        "closing_balance",
        "period_dscr",
        "cumulative_principal"
      ],
      "solvedAt": 1769461750580
    },
    {
      "id": 1769317033954,
      "templateId": "depreciation_amortization",
      "name": "Depreciation & Amortization",
      "description": "CUMSUM-based ledger pattern - no circular dependencies",
      "category": "accounting",
      "inputs": {
        "additionsRef": "R203",
        "opsFlagRef": "F2",
        "lifeYears": "C1.24",
        "method": "straight_line",
        "dbMultiplier": 2
      },
      "outputs": [
        "opening",
        "addition",
        "depreciation",
        "accumulated",
        "closing"
      ]
    },
    {
      "id": 1769320996781,
      "templateId": "gst_receivable",
      "name": "GST Paid/Received",
      "description": "GST ledger with configurable receipt delay using CUMSUM pattern",
      "category": "accounting",
      "inputs": {
        "gstBaseRef": "R112",
        "activeFlagRef": "F1",
        "gstRatePct": "C1.15",
        "receiptDelayMonths": "C1.31",
        "constructionFlagRef": "F1",
        "operationsFlagRef": "F2"
      },
      "outputs": [
        "gst_base",
        "gst_amount",
        "gst_paid",
        "receivable_opening",
        "gst_received",
        "receivable_closing",
        "net_gst_cashflow",
        "gst_received_construction",
        "gst_received_operations"
      ]
    },
    {
      "id": 1769323861808,
      "templateId": "construction_funding",
      "name": "Construction Funding",
      "description": "Construction funding waterfall with IDC equity-funded",
      "category": "financing",
      "inputs": {
        "constructionCostsRef": "R60",
        "gstPaidRef": "R61",
        "feesRef": "R173",
        "sizedDebtRef": "M1.1",
        "gearingCapPct": "C1.19",
        "interestRatePct": "R171",
        "drawdownMethod": "prorata",
        "constructionFlagRef": "F1"
      },
      "outputs": [
        "total_uses_incl_idc",
        "senior_debt",
        "equity",
        "gearing_pct",
        "cumulative_idc",
        "debt_drawdown",
        "equity_drawdown",
        "idc",
        "total_uses_ex_idc"
      ],
      "solvedAt": null
    },
    {
      "id": 1769400000000,
      "templateId": "tax_losses",
      "name": "Tax & Tax Losses",
      "description": "Tax calculation with loss carry-forward using CUMSUM pattern",
      "category": "accounting",
      "inputs": {
        "taxableIncomeRef": "R17",
        "opsFlagRef": "F2",
        "taxRatePct": "C1.11"
      },
      "outputs": [
        "taxable_income_before_losses",
        "losses_opening",
        "losses_generated",
        "losses_utilised",
        "losses_closing",
        "net_taxable_income",
        "tax_payable"
      ],
      "solvedAt": null,
      "enabled": false
    },
    {
      "id": 1769500000000,
      "templateId": "reserve_account",
      "name": "MRA (Maintenance Reserve)",
      "description": "MRA funded at construction end, draws for maintenance, releases at maintenance end",
      "category": "financing",
      "inputs": {
        "accountName": "MRA",
        "fundingAmountRef": "C1.17",
        "fundingFlagRef": "F1.End",
        "drawdownRef": "S1.19",
        "drawdownFlagRef": "F12",
        "releaseFlagRef": "F12.End"
      },
      "outputs": [
        "opening",
        "funding",
        "drawdown",
        "release",
        "closing"
      ]
    },
    {
      "id": 1769600000000,
      "templateId": "distributions",
      "name": "Distributions",
      "description": "Shareholder distributions waterfall with RE test, lock-up covenants, and share capital repayment",
      "category": "financing",
      "inputs": {
        "availableCashRef": "R170",
        "npatRef": "R19",
        "equityContributedRef": "M4.3",
        "minCashReserve": "C1.28",
        "opsFlagRef": "F2",
        "withholdingTaxPct": 0,
        "lockupActive": true,
        "lockupReleasePeriods": "C1.49",
        "dscrTestActive": true,
        "dscrRef": "M1.7",
        "dscrThreshold": "C1.47",
        "adscrTestActive": true,
        "cfadsRef": "R205",
        "debtServiceRef": "M1.5",
        "adscrThreshold": "C1.48",
        "dsraTestActive": false,
        "dsraBalanceRef": "",
        "dsraTargetRef": "",
        "quarterEndFlagRef": "T.QE"
      },
      "outputs": [
        "cash_available",
        "re_opening",
        "re_npat",
        "re_test",
        "npat_test",
        "dividend_paid",
        "re_movement",
        "re_closing",
        "sc_opening",
        "sc_cash_available",
        "sc_repayment",
        "sc_closing",
        "total_distributions",
        "withholding_tax",
        "net_to_equity",
        "dscr_test",
        "adscr_test",
        "dsra_test",
        "all_tests_pass",
        "consec_pass_qtrs",
        "lockup_active"
      ],
      "enabled": true
    },
    {
      "id": 1769700000000,
      "templateId": "dsrf",
      "name": "DSRF (Debt Service Reserve Facility)",
      "description": "Standby facility guaranteeing debt service with refinancing schedule",
      "category": "financing",
      "inputs": {
        "dsrfActiveRef": "C1.50",
        "debtServiceRef": "M1.5",
        "operationsFlagRef": "F2",
        "establishmentFeePctRef": "C1.51",
        "commitmentFeePctOfMarginRef": "C1.52",
        "baseMarginPctRef": "C1.53",
        "facilityMonthsRef": "C1.54",
        "refinancingSchedule": [
          {
            "active": true,
            "monthIndex": 60,
            "feePct": 1,
            "marginPct": 1.7
          },
          {
            "active": true,
            "monthIndex": 120,
            "feePct": 1,
            "marginPct": 1.7
          },
          {
            "active": true,
            "monthIndex": 180,
            "feePct": 1,
            "marginPct": 1.7
          },
          {
            "active": true,
            "monthIndex": 240,
            "feePct": 1,
            "marginPct": 1.7
          },
          {
            "active": false,
            "monthIndex": 0,
            "feePct": 0,
            "marginPct": 0
          }
        ]
      },
      "outputs": [
        "facility_limit",
        "establishment_fee",
        "commitment_fee",
        "refi_fees",
        "effective_margin",
        "total_dsrf_fees",
        "total_dsrf_fees_cumulative",
        "ds_plus_dsrf",
        "adjusted_dscr"
      ],
      "enabled": true
    }
  ],
  "moduleTemplates": [
    {
      "id": "construction_funding",
      "name": "Construction Funding",
      "description": "Construction funding waterfall with IDC equity-funded",
      "category": "financing",
      "inputs": [
        {
          "key": "constructionCostsRef",
          "label": "Construction Costs (cumulative)",
          "type": "reference",
          "default": "R60"
        },
        {
          "key": "gstPaidRef",
          "label": "GST Paid (cumulative)",
          "type": "reference",
          "default": "R61"
        },
        {
          "key": "feesRef",
          "label": "Fees/Other Uses (cumulative)",
          "type": "reference",
          "default": ""
        },
        {
          "key": "sizedDebtRef",
          "label": "Sized Debt (from Debt Module)",
          "type": "reference",
          "default": "M1.1"
        },
        {
          "key": "gearingCapPct",
          "label": "Gearing Cap (%)",
          "type": "number",
          "default": 65
        },
        {
          "key": "interestRatePct",
          "label": "IDC Interest Rate (%)",
          "type": "number",
          "default": 5
        },
        {
          "key": "drawdownMethod",
          "label": "Drawdown Method",
          "type": "select",
          "options": [
            {
              "value": "prorata",
              "label": "Pro-rata"
            },
            {
              "value": "equity_first",
              "label": "Equity First"
            }
          ],
          "default": "prorata"
        },
        {
          "key": "constructionFlagRef",
          "label": "Construction Flag",
          "type": "reference",
          "default": "F1"
        }
      ],
      "outputs": [
        "total_uses_incl_idc",
        "senior_debt",
        "equity",
        "gearing_pct",
        "cumulative_idc",
        "debt_drawdown",
        "equity_drawdown",
        "idc",
        "total_uses_ex_idc"
      ]
    },
    {
      "id": "reserve_account",
      "name": "Reserve Account",
      "description": "Reserve account (MRA/DSRA) with funding and drawdown using CUMSUM pattern",
      "category": "financing",
      "inputs": [
        {
          "key": "fundingAmountRef",
          "label": "Funding Amount",
          "type": "reference",
          "default": ""
        },
        {
          "key": "fundingFlagRef",
          "label": "Funding Flag (e.g., F1.End)",
          "type": "reference",
          "default": "F1.End"
        },
        {
          "key": "drawdownRef",
          "label": "Drawdown Amount (optional)",
          "type": "reference",
          "default": ""
        },
        {
          "key": "drawdownFlagRef",
          "label": "Drawdown Flag (e.g., F2)",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "releaseFlagRef",
          "label": "Release Flag (e.g., F2.End)",
          "type": "reference",
          "default": "F2.End"
        }
      ],
      "outputs": [
        "opening",
        "funding",
        "drawdown",
        "release",
        "closing"
      ]
    },
    {
      "id": "gst_receivable",
      "name": "GST Paid/Received",
      "description": "GST ledger with configurable receipt delay using CUMSUM pattern",
      "category": "accounting",
      "inputs": [
        {
          "key": "gstBaseRef",
          "label": "GST Base Amount (e.g., R112)",
          "type": "reference",
          "default": "R112"
        },
        {
          "key": "activeFlagRef",
          "label": "Active Period Flag",
          "type": "reference",
          "default": "F1"
        },
        {
          "key": "gstRatePct",
          "label": "GST Rate (%)",
          "type": "number",
          "default": 10
        },
        {
          "key": "receiptDelayMonths",
          "label": "Receipt Delay (months)",
          "type": "number",
          "default": 1
        }
      ],
      "outputs": [
        "gst_base",
        "gst_amount",
        "gst_paid",
        "receivable_opening",
        "gst_received",
        "receivable_closing",
        "net_gst_cashflow"
      ]
    },
    {
      "id": "tax_losses",
      "name": "Tax & Tax Losses",
      "description": "Tax calculation with loss carry-forward using CUMSUM pattern",
      "category": "accounting",
      "inputs": [
        {
          "key": "taxableIncomeRef",
          "label": "Taxable Income Before Losses",
          "type": "reference",
          "default": ""
        },
        {
          "key": "opsFlagRef",
          "label": "Operations Flag",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "taxRatePct",
          "label": "Tax Rate (%)",
          "type": "number",
          "default": 30
        }
      ],
      "outputs": [
        "taxable_income_before_losses",
        "losses_opening",
        "losses_generated",
        "losses_utilised",
        "losses_closing",
        "net_taxable_income",
        "tax_payable"
      ]
    },
    {
      "id": "depreciation_amortization",
      "name": "Depreciation & Amortization",
      "description": "CUMSUM-based ledger pattern - no circular dependencies",
      "category": "accounting",
      "inputs": [
        {
          "key": "additionsRef",
          "label": "Capital Additions Reference",
          "type": "reference",
          "default": "V1"
        },
        {
          "key": "opsFlagRef",
          "label": "Operations Flag",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "lifeYears",
          "label": "Useful Life (years)",
          "type": "number",
          "default": 15
        },
        {
          "key": "method",
          "label": "Depreciation Method",
          "type": "select",
          "options": [
            {
              "value": "straight_line",
              "label": "Straight Line"
            },
            {
              "value": "declining_balance",
              "label": "Declining Balance"
            }
          ],
          "default": "straight_line"
        },
        {
          "key": "dbMultiplier",
          "label": "DB Multiplier",
          "type": "select",
          "options": [
            {
              "value": 2,
              "label": "Double (2x)"
            },
            {
              "value": 1.5,
              "label": "150% (1.5x)"
            },
            {
              "value": 1,
              "label": "100% (1x)"
            }
          ],
          "default": 2
        }
      ],
      "outputs": [
        "opening",
        "addition",
        "depreciation",
        "accumulated",
        "closing"
      ]
    },
    {
      "id": "iterative_debt_sizing",
      "name": "Iterative Debt Sizing (DSCR Sculpted)",
      "description": "Binary search to find optimal debt with DSCR-sculpted repayments. Supports separate contracted/merchant DSCRs.",
      "category": "financing",
      "inputs": [
        {
          "key": "contractedCfadsRef",
          "label": "Contracted CFADS",
          "type": "reference",
          "default": "R115"
        },
        {
          "key": "contractedDSCR",
          "label": "Contracted DSCR",
          "type": "number_or_ref",
          "default": "C1.25"
        },
        {
          "key": "merchantCfadsRef",
          "label": "Merchant CFADS",
          "type": "reference",
          "default": "R116"
        },
        {
          "key": "merchantDSCR",
          "label": "Merchant DSCR",
          "type": "number_or_ref",
          "default": "C1.26"
        },
        {
          "key": "debtFlagRef",
          "label": "Debt Service Flag",
          "type": "reference",
          "default": "F8"
        },
        {
          "key": "totalFundingRef",
          "label": "Total Capex (ex-IDC)",
          "type": "reference",
          "default": "R60"
        },
        {
          "key": "maxGearingPct",
          "label": "Max Gearing (%)",
          "type": "number",
          "default": 65
        },
        {
          "key": "interestRatePct",
          "label": "Interest Rate (%)",
          "type": "number",
          "default": 5
        },
        {
          "key": "tenorYears",
          "label": "Debt Tenor (years)",
          "type": "number",
          "default": 18
        },
        {
          "key": "debtPeriod",
          "label": "Debt Service Period",
          "type": "select",
          "options": [
            {
              "value": "M",
              "label": "Monthly"
            },
            {
              "value": "Q",
              "label": "Quarterly"
            },
            {
              "value": "Y",
              "label": "Yearly"
            }
          ],
          "default": "Q"
        },
        {
          "key": "tolerance",
          "label": "Tolerance ($M)",
          "type": "number",
          "default": 0.1
        },
        {
          "key": "maxIterations",
          "label": "Max Iterations",
          "type": "number",
          "default": 50
        }
      ],
      "outputs": [
        "sized_debt",
        "opening_balance",
        "interest_payment",
        "principal_payment",
        "debt_service",
        "closing_balance",
        "period_dscr",
        "cumulative_principal"
      ]
    },
    {
      "id": "distributions",
      "name": "Distributions",
      "description": "Shareholder distributions waterfall with RE test, lock-up covenants, and share capital repayment",
      "category": "financing",
      "inputs": [
        {
          "key": "availableCashRef",
          "label": "Available Cashflow (pre-dist)",
          "type": "reference",
          "default": "R170"
        },
        {
          "key": "npatRef",
          "label": "NPAT",
          "type": "reference",
          "default": "R19"
        },
        {
          "key": "equityContributedRef",
          "label": "Equity Contributed",
          "type": "reference",
          "default": "M4.3"
        },
        {
          "key": "minCashReserve",
          "label": "Minimum Cash Reserve",
          "type": "number_or_ref",
          "default": 0
        },
        {
          "key": "opsFlagRef",
          "label": "Operations Flag",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "withholdingTaxPct",
          "label": "Withholding Tax %",
          "type": "number_or_ref",
          "default": 0
        },
        {
          "key": "lockupActive",
          "label": "Lock-up Active",
          "type": "boolean",
          "default": true
        },
        {
          "key": "lockupReleasePeriods",
          "label": "Release After (Qtrs)",
          "type": "number_or_ref",
          "default": 2
        },
        {
          "key": "dscrTestActive",
          "label": "DSCR Test Active",
          "type": "boolean",
          "default": true
        },
        {
          "key": "dscrRef",
          "label": "DSCR (periodic)",
          "type": "reference",
          "default": "M1.7"
        },
        {
          "key": "dscrThreshold",
          "label": "DSCR Threshold",
          "type": "number_or_ref",
          "default": 1.15
        },
        {
          "key": "adscrTestActive",
          "label": "Historical ADSCR Test Active",
          "type": "boolean",
          "default": true
        },
        {
          "key": "cfadsRef",
          "label": "Total CFADS",
          "type": "reference",
          "default": "R205"
        },
        {
          "key": "debtServiceRef",
          "label": "Total Debt Service",
          "type": "reference",
          "default": "M1.5"
        },
        {
          "key": "adscrThreshold",
          "label": "ADSCR Threshold",
          "type": "number_or_ref",
          "default": 1.15
        },
        {
          "key": "dsraTestActive",
          "label": "DSRA Fully Funded Test",
          "type": "boolean",
          "default": false
        },
        {
          "key": "dsraBalanceRef",
          "label": "DSRA Balance",
          "type": "reference",
          "default": ""
        },
        {
          "key": "dsraTargetRef",
          "label": "DSRA Target",
          "type": "reference",
          "default": ""
        },
        {
          "key": "quarterEndFlagRef",
          "label": "Quarter End Flag",
          "type": "reference",
          "default": "T.QE"
        }
      ],
      "outputs": [
        "cash_available",
        "re_opening",
        "re_npat",
        "re_test",
        "npat_test",
        "dividend_paid",
        "re_movement",
        "re_closing",
        "sc_opening",
        "sc_cash_available",
        "sc_repayment",
        "sc_closing",
        "total_distributions",
        "withholding_tax",
        "net_to_equity",
        "dscr_test",
        "adscr_test",
        "dsra_test",
        "all_tests_pass",
        "consec_pass_qtrs",
        "lockup_active"
      ]
    },
    {
      "id": "dsrf",
      "name": "DSRF (Debt Service Reserve Facility)",
      "description": "Standby facility guaranteeing debt service with refinancing schedule",
      "category": "financing",
      "inputs": [
        {
          "key": "dsrfActiveRef",
          "label": "DSRF Active",
          "type": "reference",
          "default": "C1.50"
        },
        {
          "key": "debtServiceRef",
          "label": "Total Debt Service",
          "type": "reference",
          "default": "R178"
        },
        {
          "key": "operationsFlagRef",
          "label": "Operations Flag",
          "type": "reference",
          "default": "F2"
        },
        {
          "key": "establishmentFeePctRef",
          "label": "Establishment Fee (%)",
          "type": "number_or_ref",
          "default": "C1.51"
        },
        {
          "key": "commitmentFeePctOfMarginRef",
          "label": "Commitment Fee (% of Margin)",
          "type": "number_or_ref",
          "default": "C1.52"
        },
        {
          "key": "baseMarginPctRef",
          "label": "Base Margin (%)",
          "type": "number_or_ref",
          "default": "C1.53"
        },
        {
          "key": "facilityMonthsRef",
          "label": "Facility Months of DS",
          "type": "number_or_ref",
          "default": "C1.54"
        },
        {
          "key": "refinancingSchedule",
          "label": "Refinancing Schedule",
          "type": "array",
          "default": []
        }
      ],
      "outputs": [
        "facility_limit",
        "establishment_fee",
        "commitment_fee",
        "refi_fees",
        "effective_margin",
        "total_dsrf_fees",
        "total_dsrf_fees_cumulative",
        "ds_plus_dsrf",
        "adjusted_dscr"
      ]
    }
  ]
}